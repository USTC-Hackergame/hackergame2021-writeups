

<h3 align="center">å¦‚å…¬å¼æ— æ³•æ˜¾ç¤ºå¯ç§»æ­¥åšå®¢ <a href="https://bipy.me/post/hackergame-2021">bipy.me</a></h3>

****

* [ç­¾åˆ°](#ç­¾åˆ°)
* [è¿›åˆ¶åå…­â€”â€”å‚ä¸Š](#è¿›åˆ¶åå…­å‚ä¸Š)
* [å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢](#å»å§è¿½å¯»è‡ªç”±çš„ç”µæ³¢)
* [çŒ«å’ªé—®ç­” Pro Max](#çŒ«å’ªé—®ç­”-pro-max)
* [å–ç“œ](#å–ç“œ)
* [é€æ˜çš„æ–‡ä»¶](#é€æ˜çš„æ–‡ä»¶)
* [æ—…è¡Œç…§ç‰‡](#æ—…è¡Œç…§ç‰‡)
* [FLAG åŠ©åŠ›å¤§çº¢åŒ…](#flag-åŠ©åŠ›å¤§çº¢åŒ…)
* [Amnesia](#amnesia)
   * [è½»åº¦å¤±å¿†](#è½»åº¦å¤±å¿†)
* [å›¾ä¹‹ä¸Šçš„ä¿¡æ¯](#å›¾ä¹‹ä¸Šçš„ä¿¡æ¯)
* [Easy RSA](#easy-rsa)
* [åŠ å¯†çš„ U ç›˜](#åŠ å¯†çš„-u-ç›˜)
* [èµ›åšå¨æˆ¿](#èµ›åšå¨æˆ¿)
   * [Level 0](#level-0)
   * [Level 1](#level-1)
* [åŠ©è®°è¯](#åŠ©è®°è¯)
   * [ç¬¬ä¸€é¡¿å¤§é¤](#ç¬¬ä¸€é¡¿å¤§é¤)
* [é©¬èµ›å…‹](#é©¬èµ›å…‹)
* [minecRaft](#minecraft)

# ç­¾åˆ°

> ä¸ºäº†èƒ½è®©å¤§å®¶é¡ºåˆ©ç­¾åˆ°ï¼Œå‘½é¢˜ç»„æŠŠæ¯ä¸€ç§’çš„ flag éƒ½è®°å½•ä¸‹æ¥åˆ¶æˆäº†æ—¥è®°æœ¬çš„ä¸€é¡µã€‚ä½ åªéœ€è¦æ‰“å¼€æ—¥è®°ï¼Œç¿»åˆ° Hackergame 2021 æ¯”èµ›è¿›è¡ŒæœŸé—´çš„ä»»ä½•ä¸€é¡µå°±èƒ½å¾—åˆ° flagï¼

![](assets/sign.webp)

ç®€å•è§‚å¯Ÿå‘ç°é¡µæ•°å¯¹åº”äº†æ—¶é—´æˆ³ï¼ˆç§’ï¼‰ï¼ŒæŒ‰ç…§é¢˜ç›®è¦æ±‚ç¿»é¡µåˆ°æ¯”èµ›æ—¥æœŸçš„ä»»æ„æ—¶é—´æˆ³å³å¯ï¼Œæ‰“å¼€ Shell è¾“å…¥å‘½ä»¤ï¼š

```bash
date +%s
# 1635000000
```

ç„¶åå¿½ç•¥æ‰ HTTP Queryï¼Œç‹‚æš´ç‚¹å‡» Next æŒ‰é’® 1635000000 æ¬¡å³å¯è½»æ¾æ‹¿åˆ° flagï½

# è¿›åˆ¶åå…­â€”â€”å‚ä¸Š

> ä¸ºä¸¥é˜² flag æ³„æ¼ä»¥åŠå…¶ä»–å­˜åœ¨äºæœªæ¥æ‰€æœ‰å¯èƒ½çš„æ„å¤–ç¾éš¾ï¼Œç¥é€šå¹¿å¤§çš„ Z åŒå­¦ä¸ä»…å¼ºåˆ¶è¦æ±‚æ¯ä¸€é“é¢˜ç›®éƒ½åŠ ä¸Šæƒé™å’Œèµ„æºçš„é™åˆ¶ï¼Œè¿˜ç»™æ‰€æœ‰å‚ä¸ Hackergame 2021 å‘½é¢˜çš„è®¡ç®—æœºæ–½åŠ äº†ä¸€å±‚æ³•æœ¯ç»“ç•Œã€‚ä»»ä½•è¯•å›¾ä»ç»“ç•Œé€ƒé€¸çš„ flag éƒ½ä¼šè¢«æ— æƒ…æŠ¹é™¤ã€‚
>
> è€Œä¸€ä½æ˜é¢ä¸Šæ˜¯è®¡ç®—æœºå­¦é™¢çš„æ–°ç”Ÿï¼Œå®åˆ™ä¸ºç‰©ç†å­¦é™¢æš—éƒ¨æ ¸å¿ƒæˆå‘˜çš„ X åŒå­¦ï¼Œåœ¨ Hackergame 2021 å‘½é¢˜ç»„å·²ç»æ½œä¼å¤šæ—¶ã€‚å¦„æƒ³è¶æ¯”èµ›å¼€å§‹çš„åˆæ—¶ï¼Œå€Ÿé˜³ç«æ­£æ—ºä¹‹åŠ¿ï¼Œå†²ç ´ Z åŒå­¦çš„ç»“ç•Œï¼Œä»¥å›¾ç‰‡è€Œéæ˜æ–‡çš„å½¢å¼ï¼Œå°† flag æ‚„æ‚„ä¼ é€’å‡ºæ¥ã€‚
>
> å¥½åœ¨ Z åŒå­¦æ³•åŠ›ä¹‹æ·±åšï¼Œä¸å¯ç®¡çª¥è ¡æµ‹ã€‚åœ¨ flag è¢«ä¼ å‡ºå»çš„å‰ä¸¤å¤©ï¼Œå°±å·²é¢„çŸ¥æ­¤äº‹å¹¶å°†å›¾ç‰‡ä¸­çš„ flag æ— å£°æ¶ˆæ³¯äº†ã€‚
>
> åªæ˜¯ï¼Œè¿™ä½ X åŒå­¦ï¼Œè™½ç„¶ä¸ä¼šé€€å‡º Vimï¼Œä½†æ˜¯ä¼¼ä¹å¯¹æ‰“å¼€åå…­è¿›åˆ¶ç¼–è¾‘å™¨é¢‡æœ‰é€ è¯£â€¦â€¦
>
> ![hex_editor](assets/hex_editor.webp)

è®°å½•ä¸‹å¯¹åº”åŒºåŸŸçš„ 16 è¿›åˆ¶ï¼Œè½¬æ¢ä¸ºæ˜æ–‡å³å¯æ‹¿åˆ° flag

# å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢

> ï¼ˆå‰æƒ…æè¦ï¼‰ ä¸ºäº†æ‰“ç ´ Z åŒå­¦å¸ƒä¸‹çš„ç»“ç•Œï¼ŒX åŒå­¦å·å·æ¬å‡ºç¤¾å›¢çš„ä¸šä½™æ— çº¿ç”µå°è¯•å›¾å‘å¤–ç•Œé€šè®¯ã€‚
>
> å½“ç„¶ï¼Œå¦‚æœåªæ˜¯è¿™æ ·è¿˜è¿œè¿œä¸å¤Ÿã€‚éµä¾å²ç§°â€œè€çˆ¹â€çš„ä¸Šå¤å…ˆè´¤çš„è‡³ç†åè¨€ï¼Œå¿…é¡»è¦â€œç”¨é­”æ³•æ‰“è´¥é­”æ³•â€ã€‚X åŒå­¦å‘ä¸Šçº§ç”³è¯·åˆ°äº†ç§‘å¤§è¥¿åŒºåŒæ­¥è¾å°„å®éªŒå®¤è®¾å¤‡çš„ä½¿ç”¨æƒé™ï¼Œä»¥æ­¤æ‰“é€šæ¬¡å…ƒç©ºé—´ï¼Œå€ŸåŠ©åˆ°å¦ä¸€ä¸ªå¹³è¡Œå®‡å®™ä¸­ Z åŒå­¦çš„æ³•åŠ›è¿›è¡Œæ•°æ®å¯¹å†²ï¼Œæ–¹æ‰äºä¹±ä¸­æå¾—ä¸€ä¸æœºä¼šï¼Œå°† flag ç”¨æ— çº¿ç”µçš„å½¢å¼å‘å°„äº†å‡ºå»ã€‚
>
> è€ƒè™‘åˆ°ä¿¡æ¯çš„é²æ£’æ€§ï¼ŒX åŒå­¦ä½¿ç”¨äº†æ— çº¿ç”µä¸­æƒ¯ç”¨çš„æ–¹æ³•æ¥åŒºåˆ†å­—ç¬¦ä¸²ä¸­è¯»éŸ³ç›¸è¿‘çš„å­—æ¯ã€‚å³ä½¿å¦‚æ­¤ï¼Œæ‰“ç ´æ¬¡å…ƒçš„å¼ºå¤§èƒ½é‡æ‰­æ›²äº†æ—¶ç©ºï¼Œä½¿å¾—æœ€ç»ˆæ¥å—åˆ°çš„å½•éŸ³çš„é€Ÿåº¦æœ‰æ‰€æ”¹å˜ã€‚
>
> ä¸ºäº†ä¿éšœåŒæ­¥è¾å°„è®¾å¤‡çš„æŒç»­è¿è½¬ï¼Œç»„ç»‡ç‰ºç‰²äº†å¤§é‡çš„èƒ½æºï¼Œç”šè‡³ä»¥ä¸œåŒ—éƒ¨åˆ†åœ°åŒºæ— è®¡åˆ’é™ç”µä¸ºä»£ä»·ï¼ŒæŠŠè¿™ä»½æ²‰ç”¸ç”¸çš„å½•éŸ³æ–‡ä»¶é€åˆ°äº†ä½ çš„æ‰‹ä¸Šã€‚è€Œåˆšåˆšèµ·åºŠæ²¡å¤šä¹…ï¼Œè¯•å›¾æŠ¢ç­¾åˆ°é¢˜ä¸€è¡€è¿˜å¤±è´¥äº†çš„ä½ ï¼Œå¯ä»¥ä¸è¾œè´ŸåŒå­¦ä»¬å¯¹ä½ çš„æ®·åˆ‡æœŸæœ›å—ï¼Ÿ
>
> æ³¨ï¼šflag èŠ±æ‹¬å·å†…åªåŒ…å«å°å†™å­—æ¯ã€‚

çœ‹å®Œä¹‹åå‘ç°ç¬¬ä¸€ä¸ªä¿¡æ¯ï¼š**ä»€ä¹ˆæ˜¯â€œæ— çº¿ç”µä¸­æƒ¯ç”¨çš„æ–¹æ³•â€ï¼Ÿ**

æœç´¢å¾—çŸ¥è¯¥æ–¹æ³•ä¸º[åŒ—çº¦éŸ³æ ‡å­—æ¯](https://zh.wikipedia.org/wiki/%E5%8C%97%E7%BA%A6%E9%9F%B3%E6%A0%87%E5%AD%97%E6%AF%8D)ï¼Œä¸‹è¡¨æ¥è‡ªç»´åŸºç™¾ç§‘ï¼š

|                 å­—æ¯                 |     ä»£ç      |         éŸ³æ ‡         |                           ä»£ç åŸæ„                           |
| :----------------------------------: | :----------: | :------------------: | :----------------------------------------------------------: |
| [A](https://zh.wikipedia.org/wiki/A) |   **Alfa**   |        ËˆÃ¦lfÉ‘         |                      é¦–ä¸ªå¸Œè…Šå­—æ¯ï¼ˆÎ±ï¼‰                       |
| [B](https://zh.wikipedia.org/wiki/B) |  **Bravo**   |       ËˆbrÉ‘ËËˆvo       |                            å–é‡‡å£°                            |
| [C](https://zh.wikipedia.org/wiki/C) | **Charlie**  |    ËˆtÊƒÉ‘Ëli ËˆÊƒÉ‘Ëli    |                        æŸ¥ç†ï¼ˆç”·å­åï¼‰                        |
| [D](https://zh.wikipedia.org/wiki/D) |  **Delta**   |        ËˆdeltÉ‘        | ç¬¬å››ä¸ªå¸Œè…Šå­—æ¯ï¼ˆÎ´ï¼‰ï¼›[ä¸‰è§’æ´²](https://zh.wikipedia.org/wiki/ä¸‰è§’æ´²) |
| [E](https://zh.wikipedia.org/wiki/E) |   **Echo**   |         Ëˆeko         |          [å›éŸ³](https://zh.wikipedia.org/wiki/å›éŸ³)          |
| [F](https://zh.wikipedia.org/wiki/F) | **Foxtrot**  |      ËˆfÉ”kstrÉ”t       |        [ç‹æ­¥èˆ](https://zh.wikipedia.org/wiki/ç‹æ­¥èˆ)        |
| [G](https://zh.wikipedia.org/wiki/G) |   **Golf**   |         É¡ÊŒlf         |      [é«˜å°”å¤«çƒ](https://zh.wikipedia.org/wiki/é«˜çˆ¾å¤«çƒ)      |
| [H](https://zh.wikipedia.org/wiki/H) |  **Hotel**   |       hoËËˆtel        |          [æ—…é¦†](https://zh.wikipedia.org/wiki/æ—…é¤¨)          |
| [I](https://zh.wikipedia.org/wiki/I) |  **India**   |       ËˆindiË‘É‘        |          [å°åº¦](https://zh.wikipedia.org/wiki/å°åº¦)          |
| [J](https://zh.wikipedia.org/wiki/J) | **Juliett**  |     ËˆdÊ’uËliË‘Ëˆet      |                       èŒ±è‰å¶ï¼ˆå¥³å­åï¼‰                       |
| [K](https://zh.wikipedia.org/wiki/K) |   **Kilo**   |        ËˆkiËlo        | [åƒ](https://zh.wikipedia.org/wiki/åƒ_(å‰ç¶´))ï¼ˆå…¬åˆ¶å•ä½çš„å‰ç¼€ï¼‰ |
| [L](https://zh.wikipedia.org/wiki/L) |   **Lima**   |        ËˆliËmÉ‘        | [åˆ©é©¬](https://zh.wikipedia.org/wiki/åˆ©é¦¬)ï¼ˆ[ç§˜é²](https://zh.wikipedia.org/wiki/ç§˜é­¯)çš„é¦–éƒ½ï¼‰ |
| [M](https://zh.wikipedia.org/wiki/M) |   **Mike**   |         mÉ‘ik         |                        éº¦å…‹ï¼ˆç”·å­åï¼‰                        |
| [N](https://zh.wikipedia.org/wiki/N) | **November** |       noËˆvembÉ™       |          [11æœˆ](https://zh.wikipedia.org/wiki/11æœˆ)          |
| [O](https://zh.wikipedia.org/wiki/O) |  **Oscar**   |        ËˆÉ”skÉ‘         |                       å¥¥æ–¯å¡ï¼ˆç”·å­åï¼‰                       |
| [P](https://zh.wikipedia.org/wiki/P) |   **Papa**   |        pÉ™ËˆpÉ‘         | çˆ¸çˆ¸ï¼ˆè®¸å¤šè¯­è¨€ä¸­å¯¹äº[çˆ¶äº²](https://zh.wikipedia.org/wiki/çˆ¶è¦ª)çš„æ˜µç§°ï¼‰ |
| [Q](https://zh.wikipedia.org/wiki/Q) |  **Quebec**  |        keËˆbek        | [é­åŒ—å…‹](https://zh.wikipedia.org/wiki/é­åŒ—å…‹)ï¼ˆ[åŠ æ‹¿å¤§](https://zh.wikipedia.org/wiki/åŠ æ‹¿å¤§)çš„ä¸€ä¸ªçœä»½ï¼‰ |
| [R](https://zh.wikipedia.org/wiki/R) |  **Romeo**   |       ËˆroËmiË‘o       |                       ç½—å¯†æ¬§ï¼ˆç”·å­åï¼‰                       |
| [S](https://zh.wikipedia.org/wiki/S) |  **Sierra**  |        siËˆerÉ‘        |          [å±±è„‰](https://zh.wikipedia.org/wiki/å±±è„ˆ)          |
| [T](https://zh.wikipedia.org/wiki/T) |  **Tango**   |        ËˆtÃ¦nÉ¡o        |          [æ¢æˆˆ](https://zh.wikipedia.org/wiki/æ¢æˆˆ)          |
| [U](https://zh.wikipedia.org/wiki/U) | **Uniform**  | ËˆjuËnifÉ”Ëm ËˆuËnifÉ”rm |          [åˆ¶æœ](https://zh.wikipedia.org/wiki/åˆ¶æœ)          |
| [V](https://zh.wikipedia.org/wiki/V) |  **Victor**  |        ËˆviktÉ‘        |                       ç»´å…‹å¤šï¼ˆç”·å­åï¼‰                       |
| [W](https://zh.wikipedia.org/wiki/W) | **Whiskey**  |        Ëˆwiski        |        [å¨å£«å¿Œ](https://zh.wikipedia.org/wiki/å¨å£«å¿Œ)        |
| [X](https://zh.wikipedia.org/wiki/X) |  **X-ray**   |       ËˆeksËˆrei       |           [Xå…‰](https://zh.wikipedia.org/wiki/Xå…‰)           |
| [Y](https://zh.wikipedia.org/wiki/Y) |  **Yankee**  |        ËˆjÃ¦nki        | [åŒ—ä½¬](https://zh.wikipedia.org/wiki/æ´‹åŸº)ï¼ˆç”¨æ¥ç§°å‘¼ç¾å›½åŒ—æ–¹äººçš„[ä¿šè¯­](https://zh.wikipedia.org/wiki/ä¿šèª)ï¼‰ |
| [Z](https://zh.wikipedia.org/wiki/Z) |   **Zulu**   |       ËˆzuËluË        | [ç¥–é²](https://zh.wikipedia.org/wiki/ç¥–é­¯)ï¼ˆä¸€ä¸ªåˆ†å¸ƒäºéæ´²å—éƒ¨çš„æ°‘æ—ï¼‰ |

ç¬¬äºŒä¸ªä¿¡æ¯ï¼š**å½•éŸ³é€Ÿåº¦æœ‰æ‰€æ”¹å˜**

éšåä¸‹è½½äº†éŸ³é¢‘ï¼Œç®€å•ï¼Œç›´æ¥ mpv å˜é€Ÿæ’­æ”¾ä¸å°±è¡Œäº†â€”â€”

```bash
mpv radio.mp3 --speed=0.3
```

ç„¶è€Œå£°éŸ³æå…¶æ¨¡ç³Šæ ¹æœ¬å¬ä¸æ¸…ï¼Œæˆ‘è¿˜å‚» fufu åœ°å¬äº†ä¸€å°æ—¶ï¼Œå‡ ä¸ªå¬ä¸æ¸…çš„å•è¯å°±åå¤å¬åå¤çŒœï¼Œç„¶è€Œæäº¤ä¸€ç›´ flag é”™è¯¯...

è¿™æ—¶æˆ‘çš„æƒ³æ³•æ˜¯è§†é¢‘éƒ½å¯ä»¥æ’å¸§ï¼Œé‚£èƒ½å¦ç»™éŸ³é¢‘â€œæ’ä¸‹å¸§â€å‘¢ï¼Ÿ

è¿™æ—¶æˆ‘æƒ³èµ·æ¥äº†æ›¾ç»åœ¨ Windows å¹³å°åˆ¶ä½œéŸ³é¢‘çš„ç»å†â€”â€”å¯æƒœç°åœ¨ç©·å­¦ç”Ÿä¹°ä¸èµ· Mac ä¸Šçš„ [Adobe Audition](https://www.adobe.com/products/audition.html)ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæœç´¢äº†ä¸€ä¸‹å‘ç°æœ‰ä¸ªå…è´¹å¼€æºçš„éŸ³é¢‘ç¼–è¾‘å™¨ [Audacity](https://www.audacityteam.org/)ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°å¾ˆå¥½ç”¨ã€‚

ä½¿ç”¨ Audacity å°†éŸ³é¢‘é€Ÿåº¦æ”¾æ…¢åˆ° 30%ï¼Œæ‚éŸ³æ¶ˆå¤±äº†ï¼Œä¸€åˆ‡å˜å¾—æ˜æœ—èµ·æ¥ï¼Œæ’­éŸ³å‘˜æµ‘åšè€Œåˆæ¸…æ™°çš„å£°éŸ³ä»¿ä½›ç”Ÿæ€•æˆ‘å¬ä¸æ‡‚ä»–åœ¨è¯´ä»€ä¹ˆ...åˆä»¿ä½›åœ¨å˜²ç¬‘æˆ‘åªä¼šç”¨ mpv...

~~åŒæ—¶è¿˜å‘ç°æˆ‘ä¹‹å‰ç¡¬çŒœçš„æœ‰å‡ ä¸ªå­—æ¯æ˜¯é”™çš„~~

äºæ˜¯ï¼Œflag åˆ°æ‰‹ã€‚

# çŒ«å’ªé—®ç­” Pro Max

> æˆ‘çŒ›ç„¶ä¸€çœ‹ï¼Œå°±çŒ›ç„¶çœ‹åˆ°è¿™ä¸ªçŒ«å’ªé—®ç­”ï¼Œæˆ‘ç›´å‘¼æˆ‘ç›´å‘¼ï¼Œä¸Šæ¬¡çœ‹åˆ°è¿™ä¹ˆè¿™ä¹ˆçš„å‘è¨€è¿˜æ˜¯ä¸Šæ¬¡ï¼Œè¿™é—®ç­”å±äºæ˜¯å…¸å‹çš„å…¸å‹äº†ï¼Œæˆ‘ä¹‹å‰è¿˜æ²¡å‘ç°ï¼Œå½“æˆ‘å‘ç°çš„æ—¶å€™æˆ‘å·²ç»å‘ç°äº†ï¼Œè¿™é—®ç­”å°±åƒä¸€ä¸ªé—®ç­”ï¼Œé—®ç­”çš„å†…å®¹å……æ»¡äº†å†…å®¹ï¼Œæˆ‘ä¸ç¦æ„Ÿæ…¨äº†ä¸€å¥æ„Ÿæ…¨ï¼šå¸Œæœ›ä¸‹æ¬¡çœ‹åˆ°è¿™ä¹ˆè¿™ä¹ˆçš„çŒ«å’ªé—®ç­”æ˜¯ä¸‹æ¬¡ã€‚

å¹´åº¦æƒ¯ä¾‹æ•´æ´»é¢˜ï¼šè€ƒå¯Ÿä¿¡æ¯æ”¶é›†èƒ½åŠ›

ä»Šå¹´çš„çŒ«å’ªé—®ç­”å¦‚ä¸‹ï¼š

1. 2017 å¹´ï¼Œä¸­ç§‘å¤§ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨ï¼ˆSEC@USTCï¼‰å¹¶å…¥ä¸­ç§‘å¤§ Linux ç”¨æˆ·åä¼šï¼ˆUSTCLUGï¼‰ã€‚ç›®å‰ï¼Œä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨çš„åŸŸåï¼ˆsec.ustc.edu.cnï¼‰å·²ç»æ— æ³•è®¿é—®ï¼Œä½†ä½ èƒ½æ‰¾åˆ°ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨çš„ç¤¾å›¢ç« ç¨‹åœ¨å“ªä¸€å¤©çš„ä¼šå‘˜ä»£è¡¨å¤§ä¼šä¸Šé€šè¿‡çš„å—ï¼Ÿ
2. ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ Linux ç”¨æˆ·åä¼šåœ¨è¿‘äº”å¹´å¤šå°‘æ¬¡è¢«è¯„ä¸ºæ ¡äº”æ˜Ÿçº§ç¤¾å›¢ï¼Ÿ
3. ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦ Linux ç”¨æˆ·åä¼šä½äºè¥¿åŒºå›¾ä¹¦é¦†çš„æ´»åŠ¨å®¤é—¨å£çš„ç‰Œå­ä¸Šâ€œLUG @ USTCâ€ä¸‹æ–¹çš„å°å­—æ˜¯ï¼Ÿ
4. åœ¨ SIGBOVIK 2021 çš„ä¸€ç¯‡å…³äºäºŒè¿›åˆ¶ Newcomb-Benford å®šå¾‹çš„è®ºæ–‡ä¸­ï¼Œä½œè€…ä¸€å…±å±•ç¤ºäº†å¤šå°‘ä¸ªæ•°æ®é›†å¯¹å…¶ç†è®ºç»“æœè¿›è¡ŒéªŒè¯ï¼Ÿ
5. ä¸ä¸¥æ ¼éµå¾ªåè®®è§„èŒƒçš„æ“ä½œç€å®ä»¤äººç”ŸåŒï¼Œå¥½åœ¨ IETF äº 2021 å¹´æˆç«‹äº† Protocol Police ä»¥ç›‘ç£å¹¶æƒ©æˆ’æ‰€æœ‰è¿èƒŒ RFC æ–‡æ¡£çš„è¡Œä¸ºä¸ªä½“ã€‚å‡å¦‚ä½ å‘ç°äº†æŸä½åŒå­¦å¯èƒ½è¿åäº†åè®®è§„èŒƒï¼Œæ ¹æ® Protocol Police ç›¸å…³æ–‡æ¡£ä¸­è§„å®šçš„ä¸¾æŠ¥æ–¹æ³•ï¼Œä½ åº”è¯¥å°†ä½ çš„ä¸¾æŠ¥ä¿¡å‘å¾€ä½•å¤„ï¼Ÿ

ç¬¬ä¸€é¢˜ç›´æ¥åœ¨ [Internet Archive](https://archive.org/) æœç´¢ `sec.ustc.edu.cn` ç›¸å…³ä¿¡æ¯å°±èƒ½æ‰¾åˆ°è¯¥ç¤¾å›¢ç« ç¨‹ã€‚

ç¬¬äºŒã€ä¸‰é¢˜ç›´æ¥åœ¨ `LUG@USTC` çš„[å®˜ç½‘](https://lug.ustc.edu.cn/)è¿›è¡Œæœç´¢å³å¯ã€‚

ç¬¬å››é¢˜è¿™ç¯‡æ–‡ç« æ‡’å¾—ä»”ç»†è¯»ï¼Œå…ˆè·³è¿‡ã€‚

ç¬¬äº”é¢˜æœç´¢å¾—åˆ° [RFC8962](https://datatracker.ietf.org/doc/html/rfc8962)ï¼Œå’Œå»å¹´çš„é£é¸½ä¼ ä¹¦ä¸€æ ·ä¹Ÿæ˜¯ç¯‡æ•´æ´»æ–‡æ¡£â€”â€”â€œå¯¹äºä¸¾æŠ¥ï¼Œè¯·å‘å¾€ `/dev/null`â€

éšåï¼Œå†™ä¸ªè„šæœ¬å¾ªç¯å‘ POST è¯·æ±‚æäº¤ç­”æ¡ˆï¼Œå…¶ä¸­ç¬¬å››é¢˜ç­”æ¡ˆä» 1 å¼€å§‹é€’å¢ï¼Œå½“ç¬¬å››é¢˜ç­”æ¡ˆä¸º 13 æ—¶ï¼Œä¾¿æ‰¾åˆ°äº† flagã€‚

# å–ç“œ

> æœ‰ä¸€ä¸ªäººå‰æ¥ä¹°ç“œã€‚
>
> HQï¼šå“¥ä»¬ï¼Œè¿™ç“œå¤šå°‘é’±ä¸€æ–¤å•Šï¼Ÿ
>
> ä½ ï¼šä¸¤å—é’±ä¸€æ–¤ã€‚
>
> HQï¼šWhat's upï¼è¿™ç“œçš®å­æ˜¯é‡‘å­åšçš„è¿˜æ˜¯ç“œç²’å­æ˜¯é‡‘å­åšçš„ï¼Ÿ
>
> ä½ ï¼šä½ ç§ç§ç°åœ¨å“ªæœ‰ç“œå•Šï¼Ÿè¿™éƒ½æ˜¯å¤§æ£šçš„ç“œï¼Œåªæœ‰ 6 æ–¤ä¸€ä¸ªå’Œ 9 æ–¤ä¸€ä¸ªçš„ï¼Œä½ å«Œè´µæˆ‘è¿˜å«Œè´µå‘¢ã€‚
>
> ï¼ˆHQ å¿ƒé‡Œé»˜é»˜ä¸€ç®—ï¼‰
>
> HQï¼šç»™æˆ‘æ¥ 20 æ–¤çš„ç“œã€‚
>
> ä½ ï¼šè¡Œï¼
>
> HQï¼šè¡Œï¼Ÿè¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ
>
> ä½ ï¼šæˆ‘å¼€æ°´æœæ‘Šçš„ï¼Œè¿˜ä¸ä¼šç§°é‡ï¼Ÿ
>
> HQï¼šæˆ‘é—®ä½ è¿™ç“œèƒ½ç§°å‡º 20 æ–¤å—ï¼Ÿ
>
> ä½ ï¼šä½ æ˜¯æ•…æ„æ‰¾èŒ¬ï¼Œæ˜¯ä¸æ˜¯ï¼Ÿä½ è¦ä¸è¦å§ï¼
>
> HQï¼šä½ è¿™ç“œè¦æ˜¯åˆšå¥½ 20 æ–¤å—æˆ‘è‚¯å®šè¦å•Šã€‚é‚£å®ƒè¦æ˜¯æ²¡æœ‰æ€ä¹ˆåŠå•Šï¼Ÿ
>
> ä½ ï¼šè¦æ˜¯ä¸æ˜¯ 20 æ–¤ï¼Œæˆ‘è‡ªå·±åƒäº†å®ƒï¼Œæ»¡æ„äº†å§ï¼Ÿ
>
> ï¼ˆä½ å¼€å§‹é€‰ç“œç§°é‡ï¼‰
>
> **è¡¥å……è¯´æ˜ï¼šå½“ç§°çš„æ•°å­—å˜ä¸ºæµ®ç‚¹æ•°è€Œä¸æ˜¯æ•´æ•°æ—¶ï¼ŒHQ ä¸ä¼šè®¤å¯æœ€ç»ˆçš„ç§°é‡ç»“æœã€‚**

![](assets/HQ-1.webp)

é¢˜ç›®å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ~~ä¼—æ‰€å‘¨çŸ¥ 6 å’Œ 9 å¯ä»¥ç»„æˆ 20~~

ä¸€çœ‹å°±éœ€è¦åˆ©ç”¨åˆ°å¤§æ•°çš„æº¢å‡ºï¼Œéšä¾¿å†™å‡ ä¸ªæ•°è¯•ä¸‹å°±ä¼šå‘ç°è¿™ä¸ªæ•°å­—å¾ˆå¤§ï¼Œåº”è¯¥æ˜¯ 64 ä½çš„

äºæ˜¯ç›´æ¥ç§° `1e19` ä¸ª 9 æ–¤çš„ç“œï¼š

![](assets/HQ-2.webp)

å˜æˆè´Ÿæ•°äº†ï¼Œå¾ˆå¥½ï¼Œç®—ä¸€ä¸‹å†æ¥å¤šå°‘ä¸ªç“œå¯ä»¥ä¸ºæ­£æ•°ï¼š

```python
# python
print("ans = %d" % (9223372036854775808 / 9))

# ans = 1024819115206086144
```

äºæ˜¯å†æ”¾ä¸Š 1024819115206086144 ä¸ª 9 æ–¤çš„ç“œï¼š

![](assets/HQ-3.webp)

å’Œé¢„æœŸä¸ä¸€æ ·ï¼Œè¿™ç“œæœçœŸç¼ºæ–¤å°‘ä¸¤ï¼ˆ

ä¸è¿‡ä¸å½±å“ï¼Œå†æ¥ 512 / 9 çº¦ç­‰äº 57 ä¸ª 9 æ–¤çš„ç“œï¼š

![](assets/HQ-4.webp)

å‡ºç°äº†ï¼Œè™šç©ºä¸€æ–¤ï¼

å†æ¬¡é‡å¤ä¸€å¥—ä»¥ä¸Šæ“ä½œï¼Œä¾¿å¾—åˆ°äº†è™šç©ºä¸¤æ–¤

è¿™ä¸¤æ–¤åŠ ä¸Šä¸¤ä¸ª 9 æ–¤ç“œï¼Œåˆšå¥½ 20 æ–¤ï¼ŒæˆåŠŸæ‹¿åˆ° flag

~~ä»å¤´åˆ°å°¾ä¹Ÿæ²¡ç”¨åˆ° 6 æ–¤çš„ç“œ~~

# é€æ˜çš„æ–‡ä»¶

> ä¸€ä¸ªé€æ˜çš„æ–‡ä»¶ï¼Œç”¨äºåœ¨ç»ˆç«¯ä¸­å±•ç¤ºä¸€ä¸ªäº”é¢œå…­è‰²çš„ flagã€‚
>
> å¯èƒ½æ˜¯åœ¨ cmd.exe ç­‰åŠ£è´¨ç»ˆç«¯ä¸­è¢«é•¿æœŸä½¿ç”¨çš„åŸå› ï¼Œè¿™ä¸ªæ–‡ä»¶å¤±å»äº†ä¸€äº›é‡è¦æˆåˆ†ï¼Œå˜æˆäº†ä¸€å †ä¹±ç ï¼Œä¹Ÿä¸ä¼šå†æ˜¾ç¤ºå‡º flag äº†ã€‚
>
> æ³¨æ„ï¼šflag å†…éƒ¨çš„å­—ç¬¦å…¨éƒ¨ä¸ºå°å†™å­—æ¯ã€‚

ä¸‹è½½æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢å……æ–¥ç€è¿™æ ·çš„ä»£ç ï¼ˆä¸‹é¢ä¸ºä¸€å°éƒ¨åˆ†ï¼‰ï¼š

```
[0;0H[20;58H[8;34H[13;27H[4;2H[38;2;1;204;177m [39m[14;10H[20;51H[23;4H[12;2H[38;2;2;207;173m [39m[19;61H[9;12H[22;8H[20;2H[38;2;3;210;169m [39m[3;23H[8;68H[19;10H[4;3H[38;2;4;214;165m [39m[19;23H[17;34H[11;52H[22;70H[12;3H[38;2;5;217;161m [39m[24;22H[2;25H[19;76H[19;3H[38;2;6;220;157m [39m[23;14H[21;12H[10;37H[2;37H[22;66H[16;45H[21;3H[38;2;7;222;153m [39m[10;47H[18;34H[23;3H[38;2;8;225;149m [39m[10;63H[3;4H[38;2;10;228;145m [39m[16;15H[21;75H[15;44H[1;48H[1;29H[4;4H[38;2;12;230;140m [39m[12;44H[13;13H[1;77H[5;60H[19;67H[12;15H[5;4H[38;2;13;233;136m [39m[11;75H[6;4H[38;2;15;235;132m 
```

ä¹‹å‰ç”¨è¿‡ ANSI Escape ä»£ç ï¼Œä¸è¿‡æ¯”è¾ƒåŸºç¡€ï¼Œ`[m` æˆ‘çŸ¥é“ï¼Œè¿™ä¸ª `[H` ç¡®å®æ˜¯æ²¡è§è¿‡

æœç´¢åˆ°ä¸€ç¯‡ [StackOverFlow](https://stackoverflow.com/a/33206814)ï¼Œä»‹ç»äº† ANSI Escape çš„åŸºæœ¬ç”¨æ³•ï¼Œå¤§æ¦‚æ˜ç™½äº† `[H`  çš„ä½œç”¨æ˜¯ç§»åŠ¨æ¸¸æ ‡

é‚£å°±ç®€å•äº†ï¼Œé¦–å…ˆæŠŠä¸¢äº†çš„æ§åˆ¶ç¬¦ `\033` åŠ ä¸Šï¼š

ç”¨ VS Code çš„æ›¿æ¢åŠŸèƒ½ï¼ŒæŠŠæ‰€æœ‰çš„`[` æ›¿æ¢ä¸º`\033[`ï¼Œå…¶ä¸­ `\033` æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œå¯ä»¥ç”±å…¶ä»–ç¨‹åº print å‡ºæ¥ç„¶åå¤åˆ¶

éšåæŠŠç©ºæ ¼å…¨éƒ¨æ›¿æ¢ä¸ºå¯è§å­—ç¬¦æ¯”å¦‚ `$`ï¼Œæœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š

```
[0;0H[20;58H[8;34H[13;27H[4;2H[38;2;1;204;177m$[39m[14;10H[20;51H[23;4H[12;2H[38;2;2;207;173m$[39m[19;61H[9;12H[22;8H[20;2H[38;2;3;210;169m$[39m[3;23H[8;68H[19;10H[4;3H[38;2;4;214;165m$[39m[19;23H[17;34H[11;52H[22;70H[12;3H[38;2;5;217;161m$[39m[24;22H[2;25H[19;76H[19;3H[38;2;6;220;157m$[39m[23;14H[21;12H[10;37H[2;37H[22;66H[16;45H[21;3H[38;2;7;222;153m$[39m[10;47H[18;34H[23;3H[38;2;8;225;149m$[39m[10;63H[3;4H[38;2;10;228;145m$[39m[16;15H[21;75H[15;44H[1;48H[1;29H[4;4H[38;2;12;230;140m$[39m[12;44H[13;13H[1;77H[5;60H[19;67H[12;15H[5;4H[38;2;13;233;136m$[39m[11;75H[6;4H[38;2;15;235;132m$
```

å°†ä¿®æ”¹åçš„è¯¥æ–‡ä»¶åœ¨ Shell æ‰“å°å‡ºæ¥ï¼š

```bash
echo -e $(cat transparent.txt)
```

ä½†æ˜¯å›¾åƒä¸€é—ªè€Œè¿‡æ ¹æœ¬çœ‹ä¸æ¸…ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ

å±å¹•å½•åˆ¶ï¼Œmpv æ‰“å¼€å½•åƒï¼ŒæŒ‰ `,` å’Œ `.` é”®ä¸€å¸§å¸§å›æ”¾ï¼Œä¸€æ°”å‘µæˆï¼ˆ

æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š

![](assets/ansi.webp)

# æ—…è¡Œç…§ç‰‡

> ä½ çš„å­¦é•¿å†³å®šæ¥ä¸€åœºè¯´èµ°å°±èµ°çš„æ—…è¡Œã€‚é€šè¿‡ä»–å‘ç»™ä½ çš„ç…§ç‰‡æ¥çœ‹ï¼Œä»–åº”è¯¥æ˜¯åœ¨é…’åº—ä½ä¸‹äº†ã€‚
>
> ![](assets/travel-photo.webp)
>
> ä»ç…§ç‰‡æ¥çœ‹ï¼Œé…’åº—ä¼¼ä¹åœ¨å°åŒºçš„ä¸€æ ‹é«˜æ¥¼é‡Œï¼Œé™„è¿‘è¿˜æœ‰ä¸€å®¶ KFC åˆ†åº—ã€‚çªç„¶ï¼Œä½ æ„è¯†åˆ°ç…§ç‰‡é‡Œé€éœ²å‡ºæ¥çš„ä¿¡æ¯æ¯”è¡¨é¢ä¸Šçœ‹èµ·æ¥çš„è¦å¤šã€‚
>
> è¯·è§‚å¯Ÿç…§ç‰‡å¹¶ç­”å¯¹å…¨éƒ¨ 5 é“é¢˜ä»¥è·å– flagã€‚æ³¨æ„ï¼šå›¾ç‰‡æœªåœ¨å…¶ä»–åœ°æ–¹å…¬å¼€å‘å¸ƒè¿‡ï¼Œä¹Ÿæœªé‡‡å–ä»»ä½•éšå†™æªæ–½ï¼ˆé€šè¿‡æ‰‹æœºæ‹æ‘„å±å¹•äº¦å¯ç­”é¢˜ï¼‰ã€‚

é€šè¿‡ç…§ç‰‡æ‰¾ä¿¡æ¯ï¼Œä¹Ÿæ˜¯é“ä¿¡æ¯æ”¶é›†é¢˜

é—®é¢˜åŠè§£ç­”å¦‚ä¸‹ï¼š

1. **è¯¥ç…§ç‰‡æ‹æ‘„è€…çš„é¢æœæ–¹å‘ä¸ºï¼š**

    è§‚å¯Ÿå·¦ä¸‹è§’æˆ¿å­ä¸Šçš„å¤ªé˜³èƒ½çƒ­æ°´å™¨ï¼Œä¸€èˆ¬éƒ½æ˜¯æœå—ï¼Œå› æ­¤å¯ä»¥åˆ¤æ–­æ‹æ‘„è€…é¢æœä¸œå—ã€‚

2. **è¯¥ç…§ç‰‡çš„æ‹æ‘„æ—¶é—´å¤§è‡´ä¸ºï¼š**

    è§‚å¯Ÿå½±å­ç»¼åˆç¬¬ä¸€é¢˜å¾—çŸ¥å¤ªé˜³åœ¨è¥¿é¢ï¼Œå› æ­¤ç›®å‰æ˜¯ä¸‹åˆåˆ°å‚æ™šçš„å¤•é˜³ã€‚

3. **è¯¥ç…§ç‰‡çš„æ‹æ‘„è€…æ‰€åœ¨æ¥¼å±‚ä¸ºï¼š**

    æœ‰åœ°å¹³çº¿å°±å¤ªå¥½åˆ¤æ–­æ¥¼å±‚äº†ï¼Œæ•°å¯¹é¢æ¥¼çš„æ¥¼å±‚å¾—çŸ¥åœ°å¹³çº¿æ‰€åœ¨ä½ç½®ä¸º 14 å±‚ï¼Œå³ä¸ºæ‹æ‘„è€…æ¥¼å±‚ã€‚

4. **è¯¥ç…§ç‰‡å·¦ä¸Šè§’ KFC åˆ†åº—çš„ç”µè¯å·ç æ˜¯ï¼š**

    ä¸é—®æˆ‘è¿˜çœŸæ²¡çœ‹åˆ°æœ‰ä¸ª KFCï¼Œç›´æ¥æœç´¢ â€œKFC æµ·è¾¹â€ å¾—åˆ°å°çº¢ä¹¦ä¸Šçš„ä¸€å †æ‰“å¡è´´â€”â€”å™¢åŸæ¥æ˜¯å…¨å›½ç‹¬æ­¤ä¸€å®¶çš„â€œç½‘çº¢ KFCâ€å•Šï¼Œä½äºç§¦çš‡å²›æ–°å¥¥æµ·åº•ä¸–ç•Œã€‚

    æ‰“å¼€ KFC å°ç¨‹åºï¼Œæœç´¢ç§¦çš‡å²›æ–°å¥¥åº—ï¼Œå³å¯å¾—çŸ¥ç”µè¯å·ç ã€‚

5. **è¯¥ç…§ç‰‡å·¦ä¸Šè§’ KFC åˆ†åº—å·¦ä¾§å»ºç­‘æœ‰ä¸‰ä¸ªæ°´å¹³æ’åˆ—çš„æ±‰å­—ï¼Œå®ƒä»¬æ˜¯ï¼š**

    åœ°å›¾æœç´¢ç§¦çš‡å²›æ–°å¥¥è¿™ä¸ªåœ°æ–¹ï¼Œæœ‰å¼ å›¾ç‰‡æŒ‡å‡ºè¿™ä¸‰ä¸ªå­—æ˜¯â€œæµ·è±šé¦†â€ã€‚

å¦‚ä¸Šæ‰€è¿°ï¼Œæäº¤å³å¯æ‹¿åˆ° flagï½

# FLAG åŠ©åŠ›å¤§çº¢åŒ…

> â€œå¬è¯´æ²¡ï¼Ÿã€å¤§ç åˆ€ã€‘å¹³å°åˆåŒå’åšæ´»åŠ¨å•¦ï¼å‚ä¸æ´»åŠ¨å°±é€ 0.5 ä¸ª flag å‘¢ï¼Œæ”’æ»¡ 1 ä¸ª flag å³å¯å…è´¹æå–ï¼â€
>
> â€œè¿˜æœ‰è¿™ä¹ˆå¥½çš„äº‹æƒ…ï¼Ÿæˆ‘ä¹Ÿè¦å‚åŠ ï¼â€
>
> â€œå¿«ç‚¹å§ï¼æˆ‘å·²ç»æ‹¿åˆ° flag äº†å‘¢ï¼å†ä¸å‚åŠ  flag å°±è¦å‘å®Œäº†å‘¢ã€‚â€
>
> â€œé‚£æ€ä¹ˆæ‰èƒ½å‚åŠ å‘¢ï¼Ÿâ€
>
> â€œè¿™è¿˜ä¸ç®€å•ï¼ç‚¹å‡»ä¸‹é¢çš„é“¾æ¥å°±è¡Œâ€

![](assets/pdd.webp)

å¾—åˆ°ä¸€ä¸ªåŠ©åŠ›é“¾æ¥ï¼Œéœ€è¦ N ä¸ªäººç‚¹äº†é“¾æ¥æ‰å¯ä»¥å¾—åˆ° flag

æ€ä¹ˆåŒºåˆ†ä¸æ˜¯åŒä¸€ä¸ªäººå‘¢ï¼Ÿçœ‹è¿™ä¸ª â€œæ´»åŠ¨è§„åˆ™â€ï¼š

> **æ´»åŠ¨è§„åˆ™:**
>
> 1. ç”¨æˆ·åœ¨æœ¬æ´»åŠ¨ä¸­å¯ä»¥é€šè¿‡é‚€è¯·å¥½å‹åŠ©åŠ›çš„æ–¹å¼è·å¾— flag æç°æœºä¼šã€‚æ”¶é›†æ»¡ 1 ä¸ª flag ï¼Œå³å¯æå– 1 ä¸ª flagã€‚
>
> 2. ç”¨æˆ·åœ¨é¡µé¢è§„å®šçš„æ—¶é—´å†…ç´¯è®¡è·å¾—çš„ flag è¾¾åˆ°ä¸€å®šçš„é—¨æ§›æ‰å¯æå–ã€‚å¦‚æœªè¾¾åˆ°é—¨æ§›ï¼Œæ‰€ç§¯ç´¯çš„ flag ä¼šå¤±æ•ˆçš„å‘¦ã€‚
>
> 3. å½“ç”¨æˆ·ç´¯è®¡çš„ flag è¾¾åˆ°ç›®æ ‡ä¹‹åï¼Œå¯ä»¥ä¿ç•™æå– flag æœºä¼š 24 å°æ—¶ï¼ˆä¿ç•™æ—¶é—´ä»å‚ä¸æ´»åŠ¨å¼€å§‹ç®—èµ·ï¼‰ã€‚é€¾æœŸæœªæå–ï¼Œflag å°†ä¼šå¤±æ•ˆã€‚
>
> 4. æ¯ä¸ªç”¨æˆ·åªèƒ½å¤ŸåŠ©åŠ›ä¸€æ¬¡ã€‚ä¸ºäº†å»ºè®¾ä¸–ç•Œä¸€æµå¤§ç åˆ€å¹³å°ï¼Œæ´»åŠ¨è¦æ±‚ä½äºåŒä¸€ /8 ç½‘æ®µçš„ç”¨æˆ·å°†ä¼šè¢«è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ã€‚ï¼ˆæ¯”å¦‚ IP åœ°å€ä¸º 202.38.64.1 å’Œ 202.39.64.1 å°†è¢«è§†ä¸ºåŒä¸€ç”¨æˆ·ã€‚ï¼‰è¾¾åˆ°åŠ©åŠ›æ¬¡æ•°ä¸Šçº¿åï¼Œå°†æ— æ³•å†å¸®åŠ©å¥½å‹åŠ©åŠ›ã€‚æˆ‘ä»¬ä½¿ç”¨**å‰åç«¯æ–¹å¼**æ£€æŸ¥ç”¨æˆ·çš„ IP ã€‚
>
> 5. å¦‚æœç”¨æˆ·ä»¥ä»»ä½•ä¸æ­£å½“æ‰‹æ®µæˆ–è€…èˆå¼Šæ–¹å¼å‚ä¸æœ¬æ´»åŠ¨ï¼Œä¸€ç»å‘ç°ï¼Œå¹³å°æœ‰æƒå¯¹è¯¥è´¦æˆ·è¿›è¡Œå¼‚å¸¸æ ‡è®°ï¼Œå¹¶é‡‡å–æ’¤é”€ flag ç­‰æ“ä½œã€‚ä¸æ­£å½“æ‰‹æ®µåŒ…æ‹¬ä½†ä¸é™äºï¼šä½¿ç”¨éæ³•å·¥å…·åˆ†äº«ã€ä¸‹è½½ã€å®‰è£…ã€æ³¨å†Œã€ç™»å½•ã€å¤šä¸ªè´¦æˆ·åŠå…¶ä»–ä¸æ­£å½“æ‰‹æ®µã€‚
>
> 6. å¦‚æœç”¨æˆ·å­˜åœ¨è¿è§„è¡Œä¸ºï¼ˆåŒ…æ‹¬ä½†ä¸é™äºéæ³•äº¤æ˜“ flag ã€æ¶æ„å¥—ç° flag ã€ä»¥ flag ä¸ºç­¹ç è¿›è¡ŒèµŒåšã€æ¶æ„æ’•æ¯ flag ç­‰ï¼‰ï¼Œå¹³å°å°†å–æ¶ˆç”¨æˆ·çš„æ´»åŠ¨èµ„æ ¼ï¼Œå¹¶æ’¤é”€å–å¾—çš„ç›¸å…³åˆ©ç›Šï¼ŒåŒæ—¶å°†ä¾æ®ç›¸å…³è§„å®šè¿›è¡Œå¤„ç†ã€‚
>
> 7. å¦‚æœå› ä¸ºä¸å¯æŠ—åŠ›æˆ–æƒ…å½¢å˜åŒ–ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºé‡å¤§è‡ªç„¶ç¾å®³ã€æ´»åŠ¨é­å—ä¸¥é‡ç½‘ç»œæ”»å‡»æˆ–ç³»ç»Ÿæ•…éšœï¼‰ï¼Œå¯¼è‡´æœ¬æ´»åŠ¨æ— æ³•æ­£å¸¸ä¸¾åŠï¼Œå¹³å°å¯ä»¥å†³å®šæš‚åœæˆ–ç»ˆæ­¢æœ¬æ´»åŠ¨ï¼Œå¹¶å¯ä¾æ®ç›¸å…³è§„å®šä¸»å¼ å…è´£ã€‚
>
> 8. æœ¬æ´»åŠ¨ä¸€åˆ‡è§£é‡Šæƒã€è£å®šæƒã€ç‹—å¤´æƒå½’å¤§ç åˆ€å¹³å°æ‰€æœ‰ã€‚

ä¹Ÿå°±æ˜¯è¯´é€šè¿‡ IP çš„å‰ 8 ä½æ¥åˆ¤æ–­ï¼Œæ€ä¹ˆä¼ªé€  IP å‘¢ï¼Ÿ

**å…ˆå°è¯•ä¸‹æœ€ç®€å•çš„ï¼Œç›´æ¥å‚æ•°ä¼ å‡ IP ç»™ä»–ï¼š**

æ„é€  payloadï¼š`ip=1.1.1.1` å‘é€ POST è¯·æ±‚â€”â€”æ˜¾ç„¶ä¼šå¤±è´¥ï¼Œæç¤º IP ä¼ªé€ 

**æƒ³äº†ä¸€ä¸‹ï¼Œä¼ªé€  proxy è½¬å‘æ—¶å¯èƒ½ä¼šåŠ ä¸Šçš„ Header `X-Real-IP`ï¼š**

ä¹Ÿä¸è¢«æœåŠ¡ç«¯è®¤å¯ï¼Œæç¤º IP ä¼ªé€ 

**æœç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰ä¸ª Header `X-Forwarded-For` å¯ä»¥ç”¨ï¼š**

Bingoï¼æˆåŠŸä¼ªé€  IPï¼Œå†™ä¸ªè„šæœ¬ä» 0 è¯·æ±‚åˆ° 255 å³å¯ï¼ˆè™½ç„¶ä¸çŸ¥é“ä»–æ¥ä¸æ¥å— 0 æˆ–è€… 255ï¼Œå‘äº†æ€»ä¸äºå˜›ï¼‰

å‘é€é€Ÿåº¦å¤ªå¿«ä¼š 502ï¼Œè¿˜éœ€è¦è®¾ç½® 100ms å‘é€ä¸€æ¬¡ï¼Œæ¯ 10 æ¬¡ç¡çœ  1 ç§’

éšååŠ©åŠ›å®Œæˆï¼Œflag åˆ°æ‰‹

# Amnesia

> ä½ çš„ç¨‹åºåªéœ€è¦è¾“å‡ºå­—ç¬¦ä¸² `Hello, world!`ï¼ˆç»“å°¾æœ‰æ— æ¢è¡Œå‡å¯ï¼‰å¹¶æ­£å¸¸ç»“æŸã€‚
>
> ç¼–è¯‘æŒ‡ä»¤ï¼š`gcc -O file.c -m32`
>
> è¿è¡ŒæŒ‡ä»¤ï¼š`./a.out`
>
> ç¼–è¯‘å™¨ç‰ˆæœ¬ï¼šDocker é•œåƒ `ustclug/debian:10` ä¸­ `apt update && apt -y upgrade && apt install -y gcc=4:8.3.0-1 gcc-multilib=4:8.3.0-1` çš„ç‰ˆæœ¬
>
> **è½»åº¦å¤±å¿†**
>
> ç¼–è¯‘å ELF æ–‡ä»¶çš„ `.data` å’Œ `.rodata` æ®µä¼šè¢«æ¸…é›¶ã€‚
>
> è¿æ¥é¢˜ç›®ï¼š`nc 202.38.93.111 10051` æˆ–[ç½‘é¡µç»ˆç«¯](http://202.38.93.111:10050/?token=2641%3AMEYCIQChHKKCzsyc%2B3Zx2zhA%2BcQjti%2BZZjnHqCa%2FOQzekJ8p%2BgIhAPrloOaxRL3Em%2Feh2j%2BGLJmonoViz7fksjn97RcFxwDO)
>
> åˆ¤é¢˜è„šæœ¬ï¼š[ä¸‹è½½](https://hack.lug.ustc.edu.cn/media/c4d3e46b-81aa-511d-a16c-e30cc5fda260/amnesia_1_checker.zip)
>
> **è®°å¿†æ¸…é™¤**
>
> ç¼–è¯‘å ELF æ–‡ä»¶çš„ `.text` æ®µä¼šè¢«æ¸…é›¶ã€‚
>
> è¿æ¥é¢˜ç›®ï¼š`nc 202.38.93.111 10061` æˆ–[ç½‘é¡µç»ˆç«¯](http://202.38.93.111:10060/?token=2641%3AMEYCIQChHKKCzsyc%2B3Zx2zhA%2BcQjti%2BZZjnHqCa%2FOQzekJ8p%2BgIhAPrloOaxRL3Em%2Feh2j%2BGLJmonoViz7fksjn97RcFxwDO)
>
> åˆ¤é¢˜è„šæœ¬ï¼š[ä¸‹è½½](https://hack.lug.ustc.edu.cn/media/c4d3e46b-81aa-511d-a16c-e30cc5fda260/amnesia_2_checker.zip)

äºŒè¿›åˆ¶é¢˜ï¼ï¼ˆå¬èµ·æ¥å°±å“ˆäººï¼Œæºœäº†

ç­‰ä¸‹ï¼Œç¬¬ä¸€é—®å¥½åƒä¸éš¾çš„æ ·å­...

## è½»åº¦å¤±å¿†

æ¸…ç©º ELF æ–‡ä»¶çš„ `.data` å’Œ `.rodata` æ®µä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

è¯•äº†ä¸€ä¸‹ï¼Œè²Œä¼¼æ˜¯å˜é‡å€¼éƒ½è¢«æ¸…ç©ºäº†ï¼Œå› æ­¤è¿™ä¸ª `Hello, world!` æ— æ³•è¢«ç¨‹åºä¿å­˜â€”â€”é‚£åªè¦æŠŠæ•°æ®å­˜åˆ°åˆ«çš„æ®µä¸å°±å¥½äº†å˜›ï¼

äºæ˜¯ï¼Œæœç´¢å¾—çŸ¥å¦‚ä½•æŒ‡å®šæ®µï¼š

```c
__attribute__((section("name")))
```

æœ€åä»£ç å°±é•¿è¿™æ ·å­ï¼š

```c
#include<stdio.h>
char s[14] __attribute__((section("bipy"))) = "Hello, world!";
char fs[3] __attribute__((section("bipy"))) = "%s";
int main() {
    printf(fs, s);
    return 0;
}
```

æäº¤ï¼ŒæˆåŠŸæ‹¿åˆ° flag

> **è®°å¿†æ¸…é™¤**
>
> ç¬¬äºŒé—®ï¼Œè¯•äº†å‡ ç§æ–¹å¼éƒ½ä¸è¡Œ
>
> æ²¡æœ‰ç†è®ºåŸºç¡€å®Œå…¨é ç¡¬çŒœææ€•ä¸å¯èƒ½åšå‡ºæ¥ï¼Œæºœäº†

# å›¾ä¹‹ä¸Šçš„ä¿¡æ¯

> å° T å¬è¯´ GraphQL æ˜¯ä¸€ç§ç‰¹åˆ«çš„ API è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯ RESTful API çš„æœ‰åŠ›ç«äº‰è€…ï¼Œæ‰€ä»¥ä»–å†™äº†ä¸ªå°ç½‘ç«™æ¥å®éªŒè¿™é¡¹æŠ€æœ¯ã€‚
>
> ä½ èƒ½é€šè¿‡è¿™ä¸ªå…¨æ–°çš„æ¥å£ï¼Œè·å–åˆ°æ²¡æœ‰å…¬å¼€å‡ºæ¥çš„ç®¡ç†å‘˜çš„é‚®ç®±åœ°å€å—ï¼Ÿ

å¦‚æœæœ‰æ¥è§¦è¿‡ GraphQL è¿™é¢˜åº”è¯¥å¾ˆç®€å•ï¼ˆ~~å¯æƒœæˆ‘æ²¡æœ‰ï¼Œåªèƒ½ç°å­¦ç°å–~~

![](assets/gql-1.webp)

ç»™äº†ä¸€ä¸ªè´¦å·`guest`ï¼Œç™»å½•ä¹‹ååˆ·æ–°ï¼Œå°±çœ‹åˆ°äº†è¿™ä¸ª gql çš„ APIï¼š

![](assets/gql-2.webp)

å‘ç° payload çš„æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š

```json
{
    "query":"{ notes(userId: 2) { id\ncontents }}"
}
```

å¤§æ¦‚å°±æ˜¯æŸ¥äº† `userId=2` è¿™ä¸ªäººçš„ç¬”è®°ï¼ŒåŒ…å« `id` å’Œ `contents` å­—æ®µï¼Œè¿”å›å¦‚ä¸‹ï¼š

```json
{
  "data": {
    "notes": [
      {
        "id": 2,
        "contents": "Flag æ˜¯ admin çš„é‚®ç®±ã€‚"
      }
    ]
  }
}
```

å°è¯•æŠŠ `userId` å†™æˆ 1 ç„¶åå‘é€ POST è¯·æ±‚ï¼Œå‘ç°æ²¡æœ‰æƒé™ï¼š

```json
{
    "query":"{ notes(userId: 1) { id\ncontents }}"
}
```

```json
{
  "errors": [
    {
      "message": "This user has no permission to access this.",
      "locations": [
        {
          "line": 1,
          "column": 3
        }
      ],
      "path": [
        "notes"
      ]
    }
  ],
  "data": {
    "notes": null
  }
}
```

é€šè¿‡æœç´¢å¾—çŸ¥ GraphQL æœ‰å±•ç¤ºæ‰€æœ‰å­—æ®µè¿™ç§åŠŸèƒ½ï¼Œæ¥è‡ª[å®˜æ–¹æ–‡æ¡£](https://graphql.org/learn/introspection/)

äºæ˜¯æ„é€  payloadï¼Œå¾—åˆ°æ‰€æœ‰ç±»å‹çš„åç§°ï¼š

```json
{
  "query": "{ __schema { types { name }}}"
}
```

```json
{
  "data": {
    "__schema": {
      "types": [
        {
          "name": "Query"
        },
        {
          "name": "GNote"
        },
        {
          "name": "Int"
        },
        {
          "name": "String"
        },
        {
          "name": "GUser"
        },
        {
          "name": "Boolean"
        },
        {
          "name": "__Schema"
        },
        {
          "name": "__Type"
        },
        {
          "name": "__TypeKind"
        },
        {
          "name": "__Field"
        },
        {
          "name": "__InputValue"
        },
        {
          "name": "__EnumValue"
        },
        {
          "name": "__Directive"
        },
        {
          "name": "__DirectiveLocation"
        }
      ]
    }
  }
}
```

æ³¨æ„åˆ°é‡Œé¢æœ‰ä¸ª `GUser`ï¼ŒæŸ¥ä»–ï¼

```json
{
  "query": "{ __type(name: \"GUser\") { fields { name }}}"
}
```

Bingoï¼å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ Email å­—æ®µçš„åç§°äº†ï¼š

```json
{
  "data": {
    "__type": {
      "fields": [
        {
          "name": "id"
        },
        {
          "name": "username"
        },
        {
          "name": "privateEmail"
        }
      ]
    }
  }
}
```

å†çœ‹çœ‹ `Query` è¿™ä¸ª type é‡Œé¢æœ‰ä»€ä¹ˆï¼š

```json
{
  "query": "{ __type(name: \"Query\") { fields { name }}}"
}
```

å¾—åˆ°æŸ¥è¯¢å­—æ®µçš„åå­—ï¼š

```json
{
  "data": {
    "__type": {
      "fields": [
        {
          "name": "note"
        },
        {
          "name": "notes"
        },
        {
          "name": "user"
        }
      ]
    }
  }
}
```

OKï¼Œè¿™æ ·ä¸‡äº‹ä¿±å¤‡ï¼Œåªå·®æœ€åä¸€æŸ¥äº†ï¼ˆå¯ä¸è¦æœ‰æƒé™æ§åˆ¶å•Šï¼‰ï¼š

```json
{
  "query": "{ user(id: 1) { id\nusername\nprivateEmail }}"
}
```

flag æˆåŠŸåˆ°æ‰‹ï¼ŒDon't Let GraphQL Leak Dataï¼

```json
{
  "data": {
    "user": {
      "id": 1,
      "username": "admin",
      "privateEmail": "flag{dont_let_graphql_l3ak_data}"
    }
  }
}
```

# Easy RSA

> è‡ªä» [Hackergame 2018 å…¬ç„¶æ­éœ²äº†å¤§æ•´æ•°å¯ä»¥è¢«ç¥ç«¥å£ç®—åˆ†è§£çš„äº‹å®](https://github.com/ustclug/hackergame2018-writeups/tree/master/official/RSA_of_Z#è§£æ³•-1)ï¼ŒRSA åœ¨ hackergame ä¸­å·²ç»åªèƒ½å¤„äºä½åˆ†å€¼çš„åœ°ä½äº†ã€‚å¦‚æœä¸åœ¨å…¶åç§°å‰é¢åŠ ä¸Š Easy è¿™ä¸ªå•è¯ï¼Œä¼¼ä¹å°±ä¼šæ˜¾å¾—å®Œå…¨å¯¹ä¸èµ·å…¶ä»–é¢˜ç›®ã€‚
>
> æ›´ä½•å†µï¼Œåœ¨æœ¬é¢˜çš„é™„ä»¶ä¸­ï¼Œä½ è¿˜è·å¾—äº†æ„é€  p å’Œ q çš„æ–¹å¼ã€‚æ•°ç†åŸºç¡€æ‰å®çš„ä½ åº”è¯¥å¯ä»¥è½»æ¾è§£å†³è¿™äº›é—®é¢˜å§ã€‚

ä¸€é“ RSA æ¨¡æ‹Ÿé¢˜ï¼Œåšå®Œåæ„Ÿè§‰æˆ‘å¯¹ RSA çš„ç†è§£åˆå‡åäº†ä¸€ç‚¹...

## é™„ä»¶

```python
import math
import sympy
from Crypto.Util.number import *

e = 65537


def get_p():
    x = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451
    y = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439
    value_p = sympy.nextprime((math.factorial(y)) % x)  # Hintï¼šè¿™é‡Œç›´æ¥è®¡ç®—ä¼šæº¢å‡ºï¼Œè¯·ä½ ä»”ç»†è§‚å¯Ÿ x å’Œ y çš„ç‰¹å¾
    return value_p


def get_q():
    value = [getPrime(256)]
    for i in range(1, 10):
        value.append(sympy.nextprime(value[i - 1]))
    print("value[-1] = ", value[-1])
    # value[-1] = 80096058210213458444437404275177554701604739094679033012396452382975889905967
    n = 1
    for i in range(10):
        n = n * value[i]
    q = getPrime(512)
    value_q = pow(q, e, n)
    print("value_q = ", value_q)
    # value_q = 5591130088089053683141520294620171646179623062803708281023766040254675625012293743465254007970358536660934858789388093688621793201658889399155357407224541324547522479617669812322262372851929223461622559971534394847970366311206823328200747893961649255426063204482192349202005330622561575868946656570678176047822163692259375233925446556338917358118222905050574458037965803154233167594946713038301249145097770337253930655681648299249481985768272321820718607757023350742647019762122572886601905212830744868048802864679734428398229280780215896045509020793530842541217790352661324630048261329493088812057300480085895399922301827190211956061083460036781018660201163819104150988531352228650991733072010425499238731811243310625701946882701082178190402011133439065106720309788819
    return sympy.nextprime(q)

# this destroyes the rsa cryptosystem
p = get_p()
q = get_q()

m = int.from_bytes(open("flag.txt", "rb").read(), "big")
c = pow(m, e, p * q)
print("c = ", c)
# c = 110644875422336073350488613774418819991169603750711465190260581119043921549811353108399064284589038384540018965816137286856268590507418636799746759551009749004176545414118128330198437101472882906564195341277423007542422286760940374859966152871273887950174522820162832774361714668826122465471705166574184367478

```

è§‚å¯Ÿå¯çŸ¥ï¼Œæœ¬é¢˜æ ¸å¿ƒåœ¨äºæ±‚å‡º `p` å’Œ `q` çš„å€¼ï¼Œç„¶åè§£å¯†è¿™ä¸ªå¯†æ–‡ `c` å³å¯

## p

`p` ç”±ä¸¤ä¸ªè´¨æ•°é˜¶ä¹˜å–æ¨¡å¾—åˆ°ï¼Œå…¶ä¸­ï¼š
$$
x=11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451
$$

$$
y=11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439
$$

æˆ‘ä»¬éœ€è¦è®¡ç®—çš„ $p$ï¼š
$$
p=y!\bmod{x}
$$
ç”±äº $y$ éå¸¸å¤§ï¼Œæƒ³è®¡ç®—ä»–çš„é˜¶ä¹˜æ˜¯ä¸å¯èƒ½çš„ï¼Œå› æ­¤éœ€è¦è§‚å¯Ÿå…¶ç‰¹å¾ï¼š
$$
y=x-99012
$$
æ²¡é”™ï¼Œ$x$ å’Œ $y$ çš„å·®å¾ˆå°ï¼Œå¯ä»¥ä½¿ç”¨ **Wilson å®šç†**æ¥è®¡ç®—é˜¶ä¹˜å–æ¨¡

> **å‚è€ƒèµ„æ–™**
>
> [å¨å°”é€Šå®šç† - OI-Wiki](https://oi-wiki.org/math/number-theory/wilson/)
>
> [Wilson's theorem - Wikipedia](https://en.wikipedia.org/wiki/Wilson%27s_theorem)
>
> [è´¹é©¬å°å®šç† - OI-Wiki](https://oi-wiki.org/math/number-theory/fermat/)

å…¶ä¸­ Wilson å®šç†çš„è¯æ˜ç”¨åˆ°äº†è´¹é©¬å°å®šç†ï¼Œæ„Ÿå…´è¶£å¯ä»¥ç ”ç©¶ä¸€ä¸‹ï¼Œæˆ‘å°±ä¸ç­é—¨å¼„æ–§äº†

æœç´¢å¾—åˆ°ä¸€ç¯‡æ–‡ç« å®ç°äº†åˆ©ç”¨ Wilson å®šç†çš„é˜¶ä¹˜å–æ¨¡è®¡ç®—ï¼Œå†™çš„éå¸¸å¥½ï¼š

[Compute n! under modulo p - GeeksforGeeks](https://www.geeksforgeeks.org/compute-n-under-modulo-p/)

ä¸è¿‡æˆ‘çœ‹äº†åŠå¤©ä¹Ÿæ²¡çœ‹æ˜ç™½åŸç†ï¼ˆæ˜¯æˆ‘å¤ªèœäº†ï¼‰ï¼Œå°±åšé¢œæ— è€»åœ°ç›´æ¥æ‹¿è¿‡æ¥ç”¨äº†ï¼š

```python
x = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451
y = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439

res = x - 1
for i in range(y + 1, x):
    res = (res * pow(i, x - 2, x)) % x

print(res)
# res = 10569944080090591401315432556965818857327680380269154543273468441025963038065648915158194147019839932524599260058098616377893091051396090650574162446875193

p = sympy.nextprime(res)
```

ç„¶åå†è®¡ç®— $res$ çš„ä¸‹ä¸€ä¸ªè´¨æ•°ï¼Œå³ä¸ºæ‰€å¾— $p$
$$
p = 10569944080090591401315432556965818857327680380269154543273468441025963038065648915158194147019839932524599260058098616377893091051396090650574162446875263
$$

## q

ç”±é™„ä»¶ï¼Œé¦–å…ˆç”Ÿæˆäº†ä¸€ä¸ªéšæœº 256 bit çš„è´¨æ•°ï¼Œç„¶åæ±‚å¾—äº†æ¥ä¸‹æ¥ 9 ä¸ªè´¨æ•°ï¼Œå…±è®¡ 10 ä¸ªè¿ç»­çš„è´¨æ•°

é€šè¿‡æ³¨é‡Šçš„ç¬¬ 10 ä¸ªè´¨æ•°ï¼Œå³å¯å€’æ¨å‡ºä»–çš„å‰ 9 ä¸ªè´¨æ•°

éšåå°†è¿™ 10 ä¸ªè´¨æ•°ç›¸ä¹˜ï¼Œå¾—åˆ° $n_{10}$ï¼Œéšåè®¡ç®—äº† $value_q$ï¼š

```python
# q ä¸ºéšæœº 512 bit è´¨æ•°
q = getPrime(512)
# æ ¹æ® e å’Œ n_10 å°† q åŠ å¯†
value_q = pow(q, e, n)
```

è¿™é‡Œç”±äºæˆ‘ä»¬çŸ¥é“æ‰€æœ‰çš„è´¨å› å­ï¼Œæ‰€ä»¥ç›´æ¥ç®—å‡ºå¯¹åº”çš„ $d_{10}$ï¼š

```python
phi = 1
for i in range(10):
    phi = phi * (value[i] - 1)

d = gmpy2.invert(e, phi)
```

ç„¶åä½¿ç”¨ $d_{10}$ å’Œ $n_{10}$ å°† $q$ è§£å¯†ï¼š

```python
q = pow(value_q, d, n)

print(q)
# 10477925992460766451892208516181598312750484426056814542870756188277177949099084361476539803367804757559880919838828678145609717295215924948786830953570263

q = sympy.nextprime(q)
```

æ ¹æ®é™„ä»¶ä»£ç ï¼Œå†å–ä¸‹ä¸€ä¸ªè´¨æ•°ï¼Œå¾—åˆ°ï¼š
$$
q=10477925992460766451892208516181598312750484426056814542870756188277177949099084361476539803367804757559880919838828678145609717295215924948786830953571811
$$
è¿™æ · $p$ å’Œ $q$ å°±éƒ½åˆ°æ‰‹äº†ï¼Œé—®é¢˜è¿åˆƒè€Œè§£

é¦–å…ˆè®¡ç®—å‡º $d$ ï¼š

```python
d = gmpy2.invert(e, (q - 1)*(p - 1))
```

ç„¶åè§£å¯† $c$ å¾—åˆ° $m$ï¼š

```python
m = pow(c, d, p * q)
print("m = ", m.to_bytes(28, "big").decode('utf-8'))
```

è½¬æˆå­—ç¬¦ä¸²ï¼Œflag åˆ°æ‰‹

# åŠ å¯†çš„ U ç›˜

> è¿™æ˜¯ä¸€ä¸ªå…³äº LUKS (Linux Unified Key Setup) çš„æ•…äº‹ã€‚
>
> ç¬¬ä¸€å¤©
>
> å° Tï¼šã€Œä½ è¦çš„éšæœºè¿‡ç¨‹çš„è¯¾ä»¶æˆ‘å¸®ä½ æ‹·å¥½äº†ï¼Œåœ¨è¿™ä¸ª U ç›˜é‡Œï¼ŒLUKS åŠ å¯†çš„å¯†ç æ˜¯ `suijiguocheng123123`ã€‚ã€
>
> å° Zï¼šã€Œå•Šï¼Œä½ åˆæäº† Linux æ–‡ä»¶ç³»ç»ŸåŠ å¯†ï¼ŒçœŸæ‹¿ä½ æ²¡åŠæ³•ã€‚æˆ‘ç°åœ¨ä¸æ–¹ä¾¿ç”¨ Linuxï¼Œæˆ‘ç›´æ¥æŠŠè¿™å—ç›˜åšæˆç£ç›˜é•œåƒæ–‡ä»¶å†å›å»å¤„ç†å§ã€‚ã€
>
> ç¬¬äºŒå¤©
>
> å° Zï¼šã€Œè°¢è°¢ä½ æ˜¨å¤©å¸®æˆ‘æ‹·çš„è¯¾ä»¶ã€‚ä½ æ¯æ¬¡éƒ½æè¿™ä¸ªåŠ å¯†ï¼Œå®ƒçœŸçš„å®‰å…¨å—ï¼Ÿã€
>
> å° Tï¼šã€Œå½“ç„¶äº†ï¼ä½ çœ‹ï¼Œä½ è¿˜ç»™æˆ‘ä¹‹åï¼Œæˆ‘å·²ç»æŠŠè¿™å—ç›˜çš„å¼±å¯†ç æ”¹æ‰äº†ï¼Œç°åœ¨æ˜¯éšæœºç”Ÿæˆçš„å¼ºå¯†ç ï¼Œè¿™æ ·é™¤äº†æˆ‘è‡ªå·±ï¼Œä¸–ç•Œä¸Šä»»ä½•äººéƒ½æ— æ³•è§£å¯†å®ƒäº†ã€‚ã€
>
> å° Zï¼šã€Œæˆ‘å¯ä¸ä¿¡ã€‚ã€
>
> å° Tï¼šã€Œä½ ä¸ä¿¡ï¼Ÿä½ çœ‹ï¼Œæˆ‘ç°åœ¨å¾€ U ç›˜é‡Œæ”¾ä¸€ä¸ª flag æ–‡ä»¶ï¼Œç„¶åè¿™ä¸ª U ç›˜å°±ç»™ä½ äº†ï¼Œä½ ç»å¯¹è§£å¯†ä¸å‡ºæ¥è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚å½“åˆæ LUKS çš„æ—¶å€™æˆ‘å¯ç ”ç©¶äº†å¥½å‡ å¤©ï¼Œç­ä¸Šå¯æ²¡äººæ¯”æˆ‘æ›´æ‡‚åŠ å¯†ï¼ã€

~~æ•æˆ‘å­¤é™‹å¯¡é—»æ²¡å¬è¯´è¿‡ LUKS~~

æœç´¢å¾—çŸ¥ LUKS æ”¹å¯†ç ä¸ä¼šæ›´æ”¹ master keyï¼Œä½¿ç”¨ master key å°±å¯ä»¥æ— éœ€å¯†ç è§£å¯† LUKS

çœŸæ­£çš„éš¾é¢˜æ¥äº† Mac M1 ç”¨æˆ·å»å“ªæ Linux å®éªŒç¯å¢ƒï¼ˆä¸æƒ³ç”¨ Server ç”Ÿäº§ç¯å¢ƒ

æŠ˜è…¾äº†ä¸€ä¼šè¿™ä¸ª Mac ARM å¥—å¨ƒ Dockerï¼Œæ‰“å¼€ä¸ª `/dev/loop` è®¾å¤‡è¿™æ²¡æƒé™ï¼Œé‚£æ²¡æƒé™

çªç„¶æƒ³åˆ°é˜¿é‡Œäº‘å¯ä»¥å…è´¹å¼€æœºå™¨ç”¨ï¼Œä¸€ä¸¤ä¸ªå°æ—¶çš„æ—¶é—´ä¹Ÿå¤Ÿç”¨äº†

é¦–å…ˆå®‰è£… `cryptsetup` å’Œ `unzip`ï¼Œç„¶åä¸‹è½½é•œåƒï¼Œè§£å‹

æ ¹æ®é¢˜ç›®æè¿°ï¼Œè¿™ä¸ªé•œåƒæ–‡ä»¶æ˜¯æ•´ä¸ª U ç›˜çš„é•œåƒï¼Œç›´æ¥ `mount` è¿˜  `mount` ä¸ä¸Šï¼Œæœç´¢å¾—çŸ¥éœ€è¦å…ˆæŠŠ image æ–‡ä»¶æåˆ° loop ä¸Šï¼š

```bash
losetup /dev/loop1 day1.img
```

ä¾ç„¶æ— æ³•æŒ‚è½½ï¼Œå†æœç´¢å¾—çŸ¥éœ€è¦ map ä¸€ä¸‹é‡Œé¢çš„åˆ†åŒºï¼š

```bash
kpartx -av /dev/loop1
```

ç„¶åæ‰“å¼€ LUKSï¼š

```bash
cryptsetup luksOpen /dev/mapper/loop1p1 day1
# then enter passphare
```

è¾“å®Œå¯†ç å³å¯æŒ‚è½½ï¼š

```bash
mount /dev/mapper/day1 /mnt/day1
```

ç„¶åé—®é¢˜æ˜¯æ€ä¹ˆè·å¾— master keyâ€”â€”æœç´¢åˆ°å‡ ç§æ–¹æ³•éƒ½æ²¡ç”¨ï¼Œæœ€ååœ¨å®˜æ–¹æ–‡æ¡£æ‰¾åˆ°ï¼š

![](assets/luks.webp)

ç„¶åå°±å¾—åˆ°äº†äºŒè¿›åˆ¶ç‰ˆ master keyï¼š

```bash
cryptsetup luksDump --dump-master-key /dev/mapper/loop1p1 --master-key-file master-key
```

ä½¿ç”¨ master key æ‰“å¼€å¹¶æŒ‚è½½ day2.imgï¼š

```bash
losetup /dev/loop2 day2.img
kpartx -av /dev/loop2
cryptsetup --master-key-file=./master-key luksOpen /dev/mapper/loop2p1 day2
mount /dev/mapper/day2 /mnt/day2
```

å®ï½æ‹¿åˆ° flagï¼š

```bash
cd /mnt/day2
cat flag.txt
```

# èµ›åšå¨æˆ¿

> è™½ç„¶è¿™æ˜¯ä½ çš„é¤å…ï¼Œä½†åªæœ‰æœºå™¨äººå¯ä»¥åœ¨å¨æˆ¿å·¥ä½œã€‚æœºå™¨äººç²¾ç¡®åœ°æŒ‰ç…§ç¨‹åºå·¥ä½œï¼Œåœ¨å¨æˆ¿ä¸­ç§»åŠ¨ï¼Œä»ç‰©å“æºå–å‡ºé£Ÿæï¼ŒæŒ‰ç…§èœè°±çš„é¡ºåºæŠŠé£Ÿæä¾æ¬¡æ”¾å…¥é”…å†…ã€‚
>
> æœºå™¨äººä¸éœ€è¦ä¼‘æ¯ï¼Œåªéœ€è¦ä¸€ä¸ªæ™šä¸Šçš„æ—¶é—´æ¥å­¦ä¹ ä½ æ•™ç»™å®ƒçš„ç¨‹åºï¼Œåœ¨æ­¤ä¹‹åä½ å°±å¯ä»¥åœ¨ä»»ä½•æ—¶å€™è®©æœºå™¨äººæ‰§è¡Œè¿™ä¸ªç¨‹åºï¼Œç¨‹åºçš„æ¯ä¸€æ­¥æ‰§è¡Œéƒ½ä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œæ–¹ä¾¿ä½ æ£€æŸ¥æœºå™¨äººåšèœçš„è¿‡ç¨‹ã€‚
>
> å¦å¤–ä¸ºäº†ç¬¦åˆé£Ÿå“å®‰å…¨æ³•çš„è¦æ±‚ï¼Œèµ›åšå¨æˆ¿ä¸­çš„æœºå™¨äººåŒä¸€æ—¶é—´æ‰‹é‡Œåªèƒ½æ‹¿ä¸€ç§é£Ÿç‰©ï¼Œæ¯æ¬¡åšèœå‰éƒ½å¿…é¡»æ‰§è¡Œæ¸…ç†å¨æˆ¿çš„æ“ä½œï¼ŒæŠŠå„å¤„çš„é£Ÿç‰©æ®‹æ¸£æ¸…ç†æ‰ï¼Œç„¶åå›åˆ°å¨æˆ¿è§’è½å¾…å‘½ã€‚
>
> æ¯å¤©çš„èœè°±å¯èƒ½ä¸åŒï¼Œä½†ä¹Ÿè®¸ä¹Ÿå­˜åœ¨ä¸€äº›è§„å¾‹ã€‚
>
> å¯¹æœºå™¨äººç¼–ç¨‹å¯ä»¥ä½¿ç”¨çš„æŒ‡ä»¤æœ‰ï¼ˆ`n, m` ä¸ºæ•´æ•°å‚æ•°ï¼Œç¨‹åºçš„è¡Œå·ä» 0 å¼€å§‹ï¼Œæ³¨æ„æŒ‡ä»¤ä¸­éœ€è¦æ­£ç¡®ä½¿ç”¨ç©ºæ ¼ï¼‰ï¼š
>
> ```
> å‘ä¸Š n æ­¥
> å‘ä¸‹ n æ­¥
> å‘å·¦ n æ­¥
> å‘å³ n æ­¥
> æ”¾ä¸‹ n ä¸ªç‰©å“
> æ‹¿èµ· n ä¸ªç‰©å“
> æ”¾ä¸‹ç›˜å­
> æ‹¿èµ·ç›˜å­
> å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸Šè·³è½¬ m è¡Œ
> å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº n å‘ä¸‹è·³è½¬ m è¡Œ
> ```
>
> èµ¶ç´§è¿›å…¥èµ›åšå¨æˆ¿å¼€å§‹åšèœå§ï¼

## Level 0

![](assets/cook-1.webp)

ç®€å•çš„ç¼–ç¨‹æ¨¡æ‹Ÿå™¨ï¼Œè¿™ä¸€å…³èœè°±ä¼šæœ‰`0, 1` å’Œ `1, 0` ä¸¤ç§æƒ…å†µï¼Œå‡†å¤‡å¥½ä¸¤ç§ç¨‹åºå³å¯ï¼š

```bash
# 0ï¼Œ1
å‘å³ 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 2 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“

# 1ï¼Œ0
å‘å³ 2 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 1 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
```

## Level 1

![](assets/cook-2.webp)

éœ€è¦æ‹¿ 73 ä¸ª 0 å·ç‰©å“ï¼Œè€Œç¨‹åºæœ€å¤šåªèƒ½æœ‰ 72 è¡Œï¼Œå› æ­¤å†™ä¸€ä¸ªå¾ªç¯å³å¯ï¼š

```bash
# 73
å‘å³ 1 æ­¥
æ‹¿èµ· 73 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å¦‚æœæ‰‹ä¸Šçš„ç‰©å“å¤§äºç­‰äº 1 å‘ä¸Šè·³è½¬ 1 è¡Œ
```

> No Win!
>
> åé¢ä¸¤å…³å°è¯•ä¿®æ”¹ jsï¼Œç»“æœå‘ç° flag æ˜¯æœåŠ¡ç«¯ä¸‹å‘çš„ï¼Œé‚ä½œç½¢

# åŠ©è®°è¯

> ä½ çš„å®¤å‹ç»ˆäºè¿å¤œèµ¶å®Œäº†ä»–çš„ Java è¯­è¨€ç¨‹åºè®¾è®¡çš„è¯¾ç¨‹å¤§ä½œä¸šã€‚çœ‹èµ·æ¥ä»–ä½¿ç”¨ Java 17 å†™äº†ä¸€ä¸ªä¿å­˜åŠ©è®°è¯çš„åç«¯ï¼Œå½“ç„¶è¿˜æœ‰é…å¥—çš„å‰ç«¯ã€‚åŠ©è®°è¯ç”±å››ä¸ªè‹±æ–‡å•è¯ç»„æˆï¼Œæ¯ä¸ªç”¨æˆ·æœ€å¤šä¿å­˜ 32 æ¡ã€‚
>
> ä½ å¹¶æ²¡æœ‰ä»”ç»†çœ‹è¿‡ä»–å†™çš„ä»»ä½•ä»£ç ï¼›å®é™…ä¸Šä½ å‹æ ¹æ²¡æœ‰é€‰è¿‡è¿™é—¨è¯¾ã€‚ç„¶è€Œï¼Œä½ çš„å®¤å‹å¹³å¸¸æ€»æ˜¯åœ¨ä½ çš„è€³è¾¹å–‹å–‹ä¸ä¼‘ Java è¿™é—¨ç¼–ç¨‹è¯­è¨€çš„ä¼˜è¶Šæ€§ï¼Œè™½ç„¶æ— éå°±æ˜¯äº›è¯¸å¦‚ã€Œå¾®æœåŠ¡ã€å’Œã€Œå¤§æ•°æ®ã€ä¹‹ç±»çš„è¯ã€‚å½“ç„¶ï¼Œä»–çš„è¯¾ç¨‹å¤§ä½œä¸šé‡Œä¼¼ä¹æ—¢æ²¡æœ‰ã€Œå¾®æœåŠ¡ã€ä¹Ÿæ²¡æœ‰ã€Œå¤§æ•°æ®ã€ï¼Œ32 æ¡è®°å½•ä¹Ÿå«ã€Œå¤§æ•°æ®ã€ï¼Ÿ
>
> ä½ æ­£ç³Šé‡Œç³Šæ¶‚åœ°æ•´ç†ç€ä½ è‡ªå·±çš„ä¹¦åŒ…ï¼Œå¹¶åœ¨å¿ƒä¸­æš—éª‚æ•™åŠ¡å¤„ä¸ºä½•è¦æŠŠè¿™é—¨è¯¾å®‰æ’åœ¨æ—©ä¸Š 7:50ã€‚ä½ çš„å®¤å‹é€šå®µäº†ä¸€æ™šä¸Šï¼Œæ­£å‡†å¤‡çˆ¬ä¸Šä»–çš„åºŠã€‚è™½ç„¶ä»–å¿™äº†ä¸€æ™šä¸Šï¼Œä½†ä»–çœ‹èµ·æ¥ä¸€ç‚¹ä¹Ÿä¸ç´¯ï¼šä»–åˆåœ¨å’Œä½ ç‚«è€€ Java åœ¨æ€§èƒ½ä¸Šçš„ä¼˜è¶Šæ€§äº†ã€‚
>
> ä½ ä»ä»–å……æ»¡æ¿€æƒ…å´åˆå¤¹æ‚ä¸æ¸…çš„è¡¨è¿°ä¸­å¾—çŸ¥ï¼Œä»–ä¼¼ä¹è¿˜ä¸ºæ­¤ä¸“é—¨åœ¨å¤§ä½œä¸šé‡Œè—äº†ä¸¤ä¸ª flagï¼šå½“è®¿é—®å»¶è¿Ÿè¾¾åˆ°ä¸¤ä¸ªç‰¹æ®Šçš„é˜ˆå€¼æ—¶ï¼Œflag ä¾¿ä¼šæ‰“å°å‡ºæ¥ï¼Œå±Šæ—¶ä½ ä¾¿å¯ä»¥æ‹¿ç€ flag è®©ä½ çš„å®¤å‹è¯·ä½ åƒä¸€é¡¿å¤§é¤ã€‚
>
> è¯·åƒé¥­å€’æ˜¯æ¬¡è¦äº†ï¼Œé‡ç‚¹æ˜¯æƒ³ä¸ªåŠæ³•æ€æ€ä»–çš„é”æ°”â€”â€”ä½ åœ¨å¿ƒé‡Œè¿™æ ·æƒ³ç€ã€‚çªç„¶ï¼Œä½ å›æƒ³èµ·æ¥ä½ çš„å®¤å‹åœ¨å‡ å¤©å‰ä¸ºæ–¹ä¾¿è°ƒè¯•ï¼Œåœ¨ä»£ç é‡Œäººä¸ºæ·»åŠ äº†ä¸€æ®µå»¶æ—¶ä»£ç ï¼Œä¹Ÿä¸çŸ¥é“ä»–æœ‰æ²¡æœ‰åˆ æ‰ã€‚ä»–ä¹‹å‰ç”šè‡³è¿˜æœä½ ç‚«è€€è¿‡ä»–çš„è¿™ä¸€ã€ŒæŠ€æœ¯ã€ï¼Œå› ä¸ºã€Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿æ‰‹åŠ¨æš‚åœäº†ã€â€”â€”è‡³äºä¸ºä»€ä¹ˆä»–è¿æ‰“æ–­ç‚¹éƒ½ä¸ä¼šï¼Œé‚£å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚
>
> ä½ å†³å®šåœ¨ä»Šå¤©æ—©ä¸Šçš„è¯¾ä¸ŠæŠŠä½ å®¤å‹çš„å¤§ä½œä¸šæ‹¿è¿‡æ¥è¯•ä¸€è¯•â€”â€”åæ­£è¿™é—¨è¯¾å·²ç»å¤Ÿæ— èŠäº†ï¼Œè¿˜ä¸å¦‚æç‚¹æœ‰æ„æ€çš„ã€‚

## ç¬¬ä¸€é¡¿å¤§é¤

å…¶å®å°±æ˜¯ Java çš„ä¸€ä¸ª RESTful APIï¼ŒæŠ“åŒ…æ‹¿åˆ° API

ç„¶åè§‚å¯Ÿæºä»£ç ï¼Œå‘ç°éœ€è¦åœ¨ä¸€ä¸ªå¾ªç¯é‡Œé¢è¿è¡Œ 600 ms ä»¥ä¸Šï¼Œéšåé©¬ä¸Šæ³¨æ„åˆ° `Phrase` è¿™ä¸ª `record` é‡Œé¢æœ‰ä¸ª `sleep` å‡½æ•°

```java
@Override
public boolean equals(Object o)
{
    if (o instanceof Phrase that)
    {
        try
        {
            TimeUnit.MILLISECONDS.sleep(EQUALS_DURATION_MILLIS); // TODO: remove it since it is for debugging
        }
        catch (InterruptedException e)
        {
            throw new RuntimeException(e);
        }
        return that.text.equals(this.text) && that.time.equals(this.time) && that.user.equals(this.user);
    }
    return false;
}
```

åˆæ³¨æ„åˆ°å‚¨å­˜å®¹å™¨ä½¿ç”¨çš„æ˜¯ `LinkedHashSet`ï¼Œé‚£æ’å…¥æ•°æ®æ—¶è‚¯å®šå°±ä¼šè°ƒç”¨`Phrase` è‡ªå·± override çš„ `hashCode()` æ–¹æ³•ï¼š

```java
@Override
public int hashCode()
{
    return Objects.hash(this.text, this.time, this.user);
}
```

åˆæ³¨æ„åˆ°è¿™ä¸ªæ–¹æ³•æŠŠæ—¶é—´æˆ³æ”¾è¿›å»åš hash è¿ç®—äº†ï¼Œå› æ­¤åªéœ€è¦åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­å‘é€é‡å¤çš„ 32 ä¸ªå­—ç¬¦ä¸²ï¼Œç”±äºæ¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ—¶é—´æˆ³å’Œç”¨æˆ·éƒ½ä¸€è‡´ï¼Œè‡ªç„¶ä¼š hash å†²çªï¼Œå…±è®¡è°ƒç”¨32æ¬¡ `equals()`ï¼Œæ¯æ¬¡ç¡ 20 msï¼Œå³å¯è¾¾åˆ° 600 ms æ‹¿åˆ° flag

> **ç¬¬äºŒé¡¿å¤§é¤**
>
> ä¸€æ ·çš„ç³»ç»Ÿï¼Œè¦åšåˆ° 9000 ms éœ€è¦æ„é€  32 ä¸ªæ»¡è¶³åœ¨ HashSet é‡Œé¢ä½ç½®å†²æ’ä½†ä¸ç›¸åŒçš„ `Phrase`ï¼Œè¿™æ · Set é€€åŒ–æˆé“¾è¡¨ä¹‹åæ¯æ¬¡æ’å…¥è°ƒç”¨å¹³å‡ 15 æ¬¡ `equals()`
>
> ```java
> int pos = (n - 1) & ((h = Objects.hash(text, time, user)) ^ (h >>> 16));
> ```
>
> å°è¯•æ„é€ äº†ä¸€ä¼šï¼Œä¸€æƒ³åˆ°å¤§äº 16 ä¸ªæ•°çš„æ—¶å€™è¿˜è¦æ‰©å®¹ï¼Œè¿˜è¦å¸¦ç€æ—¶é—´æˆ³...
>
> çœŸä¸æ„§æ˜¯æŒ‚ç€æ•°å­¦ tag çš„ï¼Œæƒ¹ä¸èµ·ï¼Œæºœäº†...

# é©¬èµ›å…‹

> å…±äº«å•è½¦åªå‰©ä¸‹ä¸€è¾†ï¼Œèµ°è¿‘ä¸€çœ‹ï¼Œæœç„¶æ˜¯ä¸€è¾†äºŒç»´ç è¢«åäººæ¶‚æ‰ä¸€å¤§å—çš„è½¦ï¼Œè°ä¹Ÿéª‘ä¸èµ°ã€‚
>
> > æˆ‘ä»Šå¤©è¿˜éå°±è¦æŠŠè¿™ä¸ªè¾†è½¦éª‘èµ°ã€‚
>
> äºæ˜¯ä½ å¼€å§‹ç ”ç©¶èµ·æ¥è¿™ä¸ªäºŒç»´ç ã€‚
>
> ![qrcode](assets/qrcode.webp)

ä¸€ä¸ªè¢«æ‰“äº†ç çš„äºŒç»´ç ï¼ŒåŒæ—¶æä¾›äº†ç”Ÿæˆç®—æ³•â€”â€”

äºæ˜¯æˆ‘è·¯å­æˆåŠŸèµ°æ­ªäº†ï¼Œç”Ÿæˆäº† 3000 å¼ å›¾ç‰‡ç‚¼ä¸¹å»äº†ï¼Œæœ€åå‘ç°ç›´æ¥è¿‡æ‹Ÿåˆï¼Œæ•ˆæœä¸æ€ä¹ˆå¥½

æ€ä¹ˆåŠå‘¢ï¼Ÿè§‚å¯Ÿäº†ä¸€ä¸‹é©¬èµ›å…‹çš„è¾¹ç•Œï¼Œè·ŸäºŒç»´ç çš„è¾¹ç•ŒåŸºæœ¬ä¸Šéƒ½æ˜¯é”™å¼€çš„ï¼Œäºæ˜¯ç”Ÿæˆäº†ä¸€ä¸ª CSV åˆ° Excel é‡Œé¢å°è¯•ç ”ç©¶ä¸€ä¸‹è§„å¾‹ï¼š

![](assets/qrcode-1.webp)

æ‹¿çº¸ç¬”ç®—äº†ä¸¤ä¸ªæ¡†ï¼Œå‘ç°æœ‰æˆï¼Œç›´æ¥æŠ„èµ· C++ å¼€å§‹å†™ï¼š

```c++
#include <iostream>
#include <vector>
#include <fstream>
#include <cmath>
#include <deque>
#include <unordered_map>
#include <unordered_set>

using namespace std;

/**
 * O -------------> Y
 * |
 * |    QR Code
 * |
 * |
 * X
 */

struct Box {
    int total;
    int val;
    int x1, x2, y1, y2;
    bool lock;
};

struct Block {
    int val{}; // 255 or 0
    bool lock{};
};

struct Mosaic {
    bool lock{};
    int idx_i{}, idx_j{};
    int val{};
    int x1{}, x2{}, y1{}, y2{};
    vector<int> possible_white;
    vector<vector<Box> > grid;
};

bool flag = false;
vector<vector<int> > QRCode;
vector<vector<Mosaic> > MosaicMap;
vector<vector<Block> > BlockMap;

void mark(int x, int y) {
    int x1 = x, y1 = y, x2 = x1 + 55, y2 = y1 + 55;
    for (int i = x1; i < x2; i++) {
        for (int j = y1; j < y2; j++) {
            QRCode[i][j] = 0;
        }
    }
    for (int i = x1 + 11; i < x2 - 11; i++) {
        for (int j = y1 + 11; j < y2 - 11; j++) {
            QRCode[i][j] = 255;
        }
    }
    for (int i = x1 + 22; i < x2 - 22; i++) {
        for (int j = y1 + 22; j < y2 - 22; j++) {
            QRCode[i][j] = 0;
        }
    }
}

void load_data(const string &path) {
    ifstream data_in(path, ios::in);
    if (!data_in) {
        cout << "y";
    }
    string line;
    for (int i = 0; i < 57 * 11; i++) {
        getline(data_in, line);
        int pre = 0, idx = 0;
        for (int j = 0; j < line.length(); j++) {
            if (line[j] == ',') {
                QRCode[i][idx] = stoi(line.substr(pre, j - pre));
                pre = j + 1;
                idx++;
            }
        }
        QRCode[i][idx] = stoi(line.substr(pre));
    }
    data_in.close();

    mark(286, 286);
    mark(528, 528);
    mark(528, 286);
    mark(286, 528);

    for (int i = 0; i < 57 * 11; i++) {
        for (int j = 0; j < 57 * 11; j++) {
            if (!BlockMap[i / 11][j / 11].lock) {
                if (QRCode[i][j] == 0 || QRCode[i][j] == 255) {
                    BlockMap[i / 11][j / 11].val = QRCode[i][j];
                    BlockMap[i / 11][j / 11].lock = true;
                }
            }
        }
    }

    for (int i = 0; i < 20; i++) {
        for (int j = 0; j < 20; j++) {
            Mosaic cur;
            cur.lock = true;
            cur.idx_i = i;
            cur.idx_j = j;
            cur.x1 = 103 + i * 23;
            cur.y1 = 137 + j * 23;
            cur.x2 = cur.x1 + 22;
            cur.y2 = cur.y1 + 22;
            cur.val = QRCode[cur.x1][cur.y1];
            for (int k = ceil((23 * 23 * cur.val) / 255.0); (255 * k) / (23 * 23) == cur.val; k++) {
                cur.possible_white.push_back(k);
            }
            int p = cur.x1, q = cur.y1;
            while (p <= cur.x2) {
                cur.grid.push_back(move(vector<Box>()));
                while (q <= cur.y2) {
                    Box box{};
                    box.x1 = p;
                    box.y1 = q;
                    box.x2 = min(cur.x2, box.x1 + (10 - box.x1 % 11));
                    box.y2 = min(cur.y2, box.y1 + (10 - box.y1 % 11));
                    if (BlockMap[p / 11][q / 11].lock) {
                        box.val = BlockMap[p / 11][q / 11].val;
                        box.lock = true;
                    } else {
                        box.val = -1;
                        box.lock = false;
                    }
                    box.total = (box.y2 - box.y1 + 1) * (box.x2 - box.x1 + 1);
                    cur.grid.back().push_back(box);
                    q = box.y2 + 1;
                }
                if (q > cur.y2) {
                    q = cur.y1;
                }
                p = cur.grid.back().back().x2 + 1;
            }
            // clean is true if and only if boxes are true
            for (int u = 0; u < cur.grid.size(); u++) {
                for (int o = 0; o < cur.grid[0].size(); o++) {
                    cur.lock &= cur.grid[u][o].lock;
                }
            }
            MosaicMap[i][j] = cur;
        }
    }
}

void combination(vector<Box *> &source, vector<vector<int> > &ans, vector<int> &temp, int cur) {
    ans.emplace_back(temp);
    if (cur == source.size()) {
        return;
    }
    for (int i = cur; i < source.size(); i++) {
        temp.emplace_back(i);
        combination(source, ans, temp, i + 1);
        temp.pop_back();
    }
}

void bfs_v2(int start_x, int start_y) {
    vector<vector<bool> > visited(20, vector<bool>(20, false));
    deque<Mosaic *> dq;
    dq.emplace_back(&MosaicMap[start_x][start_y]);
    visited[start_x][start_y] = true;
    while (!dq.empty()) {
        auto cur = dq.front();
        if (!cur->lock) {
            // edge
            int sum = 0;
            for (int i = 0; i < cur->grid.size(); i++) {
                for (int j = 0; j < cur->grid[0].size(); j++) {
                    if (BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].lock) {
                        cur->grid[i][j].val = BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].val;
                        cur->grid[i][j].lock = true;
                    }
                    if (cur->grid[i][j].val == 255) {
                        sum += cur->grid[i][j].total;
                    }
                }
            }
            // judge inside
            vector<Box *> judge;
            for (int i = 0; i < cur->grid.size(); i++) {
                for (int j = 0; j < cur->grid[0].size(); j++) {
                    if (!cur->grid[i][j].lock) {
                        judge.emplace_back(&cur->grid[i][j]);
                    }
                }
            }
            vector<vector<int> > comb, possible_comb;
            vector<int> temp;
            combination(judge, comb, temp, 0);
            for (auto &it: comb) {
                int total = 0;
                for (int i: it) {
                    total += judge[i]->total;
                }
                for (int i: cur->possible_white) {
                    if (i - sum == total) {
                        possible_comb.emplace_back(it);
                    }
                }
            }
            if (!possible_comb.empty()) {
                if (possible_comb.size() > 1) {
                    unordered_map<int, int> m;
                    for (auto &i : possible_comb) {
                        for (int j : i) {
                            m[j]++;
                        }
                    }
                    for (auto &it : m) {
                        if (it.second == possible_comb.size()) {
                            judge[it.first]->val = 255;
                            judge[it.first]->lock = true;
                        }
                    }
                } else {
                    for (int i: possible_comb[0]) {
                        judge[i]->val = 255;
                        judge[i]->lock = true;
                    }
                    for (Box *b: judge) {
                        if (b->val == -1) {
                            b->val = 0;
                            b->lock = true;
                        }
                    }
                    cout << "R-Down: (" << cur->idx_i << "," << cur->idx_j << ")" << endl;
                }
            }
            cur->lock = true;
            for (int i = 0; i < cur->grid.size(); i++) {
                for (int j = 0; j < cur->grid[0].size(); j++) {
                    cur->lock &= cur->grid[i][j].lock;
                }
            }
            // back
            for (int i = 0; i < cur->grid.size(); i++) {
                for (int j = 0; j < cur->grid[0].size(); j++) {
                    if (!BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].lock) {
                        if (cur->grid[i][j].lock) {
                            BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].val = cur->grid[i][j].val;
                            BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].lock = true;
                        }
                    } else if (cur->grid[i][j].lock && BlockMap[cur->grid[i][j].x1 / 11][cur->grid[i][j].y1 / 11].val != cur->grid[i][j].val) {
                        cout << "Unexpect Behavior! Grid: " << cur->grid[i][j].x1 << ", " << cur->grid[i][j].y1 << endl;
                    }
                }
            }
        }
        // next
        if (cur->idx_i + 1 < 20 && !visited[cur->idx_i + 1][cur->idx_j]) {
            visited[cur->idx_i + 1][cur->idx_j] = true;
            dq.emplace_back(&MosaicMap[cur->idx_i + 1][cur->idx_j]);
        }
        if (cur->idx_j + 1 < 20 && !visited[cur->idx_i][cur->idx_j + 1]) {
            visited[cur->idx_i][cur->idx_j + 1] = true;
            dq.emplace_back(&MosaicMap[cur->idx_i][cur->idx_j + 1]);
        }
        // pop
        dq.pop_front();
    }
}

int main() {
    QRCode.resize(57 * 11, vector<int>(57 * 11));
    MosaicMap.resize(20, vector<Mosaic>(20));
    BlockMap.resize(57, vector<Block>(57));
    load_data("img.csv");

    int cnt = 0;
    flag = false;
    while (cnt <= 30) {
        cout << "Epoch - " << cnt++ << endl;
        bfs_v2(0, 0);
    }
    int unknown_cnt = 0;
    for (int i = 0; i < 57; i++) {
        for (int j = 0; j < 57; j++) {
            if (!BlockMap[i][j].lock) {
                unknown_cnt++;
            }
        }
    }
    cout << "Unknown - " << unknown_cnt << " / 1681" << endl;
    // do clean / lazy
    for (int i = 103; i < 563; i++) {
        for (int j = 137; j < 597; j++) {
            if (BlockMap[i / 11][j / 11].lock) {
                QRCode[i][j] = BlockMap[i / 11][j / 11].val;
            } else {
                QRCode[i][j] = 128;
            }
        }
    }
    // output
    ofstream data_out("out_img.csv", ios::out | ios::trunc);
    for (int i = 0; i < QRCode.size(); i++) {
        data_out << QRCode[i][0];
        for (int j = 0; j < QRCode[0].size(); j++) {
            data_out << "," << QRCode[i][j];
        }
        data_out << endl;
    }
    return 0;
}
```

ä¸€ä¸ªç®€æ˜“ PoCï¼Œæ€»ä½“æ€è·¯æ˜¯é¦–å…ˆå°†è¢«é®ä½çš„å››ä¸ªå®šä½ç‚¹ç¡®å®šä¸‹æ¥ï¼Œç„¶ååœ¨æ•´å¼ å›¾ä¸Šå¯»æ‰¾ç¡®å®šçš„è‰²å—ï¼Œç„¶ååŸºäºå½“å‰ä¿¡æ¯å»ç¡®å®šæ›´å¤šè‰²å—ã€‚å¦‚æœæœ‰å¤šç§å¯èƒ½ä¸èƒ½ç¡®å®šï¼Œåˆ™æš‚æ—¶èˆå¼ƒï¼ˆåªä¿®æ”¹ç»å¯¹ç¡®å®šçš„è‰²å—ï¼Œé˜²æ­¢è´è¶æ•ˆåº”ï¼‰ã€‚

æ¯ä¸€è½®æ˜¯ä¸€æ¬¡ä¸€æ¨¡ä¸€æ ·çš„ BFSï¼Œå› ä¸ºåé¢çš„ä¿®æ”¹æœ‰å¯èƒ½æƒ åŠåˆ°å‰é¢ï¼Œæ‰€ä»¥å¤šè·‘å‡ è½®ã€‚

æœ€åå°†æœªç¡®å®šçš„å—æ¶‚ç°å¹¶è¾“å‡ºï¼Œæ‹¿åˆ° CSV å†ç”¨ Python æŒ‰åŒæ ·çš„æ–¹æ³•ç”ŸæˆäºŒç»´ç ï¼š

![out_qrcode](assets/out_qrcode.webp)

è™½ç„¶ä¸å…¨ï¼Œä½†æ˜¯åœ¨ 30% çš„å®¹é”™ä¹‹å†…äº†ï¼Œç›´æ¥æ‹¿æ‰‹æœºæ‰«ç å³å¯æ‹¿åˆ° flag

# minecRaft

> kk åŒå­¦å¾ˆå–œæ¬¢ç© Minecraftï¼Œä»–æœ€è¿‘æ”¶åˆ°äº†ä¸€å¼  MC åœ°å›¾ï¼Œåœ°å›¾é‡Œé¢æœ‰ä¸‰ç›ç¯ï¼Œè¿˜æœ‰å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å‹åŠ›æ¿ã€‚
>
> ä½†ä»–å‘ç°è¿™äº›ç¯å¥½åƒä¸å¤ªç¬¦åˆ MC ç”µç£å­¦ï¼ˆRed stoneï¼‰ï¼Œä½ èƒ½å¸®ä»–æŠŠç¯å…¨éƒ¨ç‚¹äº®å—ï¼Ÿ
>
> æ³¨ï¼šæœ¬é¢˜è§£æ³•ä¸åŸç‰ˆ Minecraft æ¸¸æˆæ— å…³ã€‚

![](assets/minecraft.webp)

æ‰“å¼€å‘ç°æ˜¯ä¸ªç½‘é¡µç‰ˆçš„ Minecraftï¼Œè¹¦è¹¦è·³è·³äº†ä¸€ä¼šï¼Œå‘ç°æ¸¸æˆç›®æ ‡å°±æ˜¯è¸©å‹åŠ›æ¿å‡‘å¤Ÿ 32 ä¸ªå­—ç¬¦

~~äºæ˜¯æ„‰å¿«åœ°æŠŠ 32 ä½çš„ flag è¸©å‡ºæ¥äº†ï¼Œç»“æŸï½~~

æ‰“å¼€ DevToolsï¼Œè§‚å¯Ÿ Sourcesï¼Œå‘ç°åªæœ‰ `flag.js` å’Œ `index.html` æ˜¯ä¸é¢˜ç›®ç›¸å…³çš„ï¼Œå› æ­¤æŠŠä»–ä»¬ copy åˆ°æœ¬åœ°ï¼Œèµ·äº†ä¸€ä¸ªé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œç„¶åè®¿é—®ï¼š

```bash
cd minecraft
caddy file-server
# goto http://127.0.0.1/
```

éšåè¾¹æ”¹æ–‡ä»¶è¾¹è°ƒè¯•ï¼Œè§‚å¯Ÿ `index.html` å‘ç°äº†è¿™ä¸ªå‡½æ•°ï¼š

```javascript
function printcinput(){
    let content=document.getElementById('spann');
    if (cinput[0]==='M') {
        if (pressplateList[64].status===false){
            pressplateList[64].TurnOn_redstone_lamp();
            pressplateList[64].status=true;
        }
    }
    if(cinput.length>=32){
        let tbool=gyflagh(cinput.join(''));
        if(tbool) {
            pressplateList[65].TurnOn_redstone_lamp();
            content.innerText='Congratulations!!!';
            return;
        }
        cinput.length=0;
    }
    content.innerText=cinput.join('');
}
```

è¡¨æ˜å°†è¾“å…¥çš„å­—ç¬¦ä¸²ç”¨ `gyflagh()` è¿™ä¸ªå‡½æ•°åˆ¤æ–­äº†ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯ `true` åˆ™æ¸¸æˆç»“æŸï¼Œé‚£å°±æ¥ç€çœ‹çœ‹è¿™ä¸ªå‡½æ•°å§

é¦–å…ˆæŠŠç»è¿‡æ··æ·†çš„ `flag.js` æ ¼å¼åŒ–äº†ä¸€ä¸‹ï¼Œç„¶åè§‚å¯Ÿä»ç¨‹åºå…¥å£ `gyflagh()` å¼€å§‹éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼š

```javascript
const _0x22517d = _0x2c9e;
(function(_0x2018e5, _0xd122c5) {
    const _0x4a600d = _0x2c9e,
        _0x2e34d2 = _0x2018e5();
    while (!![]) {
        try {
            const _0x4d38c4 = -parseInt(_0x4a600d(0x1b1)) / 0x1 * (parseInt(_0x4a600d(0x1ad)) / 0x2) + -parseInt(_0x4a600d(0x1b2)) / 0x3 * (parseInt(_0x4a600d(0x1b6)) / 0x4) + -parseInt(_0x4a600d(0x1ae)) / 0x5 * (-parseInt(_0x4a600d(0x1b4)) / 0x6) + parseInt(_0x4a600d(0x1ab)) / 0x7 * (parseInt(_0x4a600d(0x1af)) / 0x8) + parseInt(_0x4a600d(0x1b5)) / 0x9 + -parseInt(_0x4a600d(0x1b3)) / 0xa + -parseInt(_0x4a600d(0x1a9)) / 0xb * (-parseInt(_0x4a600d(0x1a7)) / 0xc);
            if (_0x4d38c4 === _0xd122c5) break;
            else _0x2e34d2['push'](_0x2e34d2['shift']());
        } catch (_0x416145) {
            _0x2e34d2['push'](_0x2e34d2['shift']());
        }
    }
}(_0x381b, 0x21c08), String['prototype'][_0x22517d(0x1a8)] = function(_0x6a2659) {
    const _0x13519e = _0x22517d,
        _0x267e12 = new Array(0x2),
        _0x11a961 = new Array(0x4);
    let _0x1bf548 = '';
    console.log("this=")
    console.log(this)
    plaintext = escape(this);
    console.log("plaintext=")
    console.log(plaintext)
    for (var _0x485827 = 0x0; _0x485827 < 0x4; _0x485827++) _0x11a961[_0x485827] = Str4ToLong(_0x6a2659[_0x13519e(0x1a6)](_0x485827 * 0x4, (_0x485827 + 0x1) * 0x4));
    for (_0x485827 = 0x0; _0x485827 < plaintext[_0x13519e(0x1b8)]; _0x485827 += 0x8) {
        _0x267e12[0x0] = Str4ToLong(plaintext['slice'](_0x485827, _0x485827 + 0x4)), _0x267e12[0x1] = Str4ToLong(plaintext[_0x13519e(0x1a6)](_0x485827 + 0x4, _0x485827 + 0x8)), code(_0x267e12, _0x11a961), _0x1bf548 += LongToBase16(_0x267e12[0x0]) + LongToBase16(_0x267e12[0x1]);
    }
    return _0x1bf548;
});

function _0x2c9e(_0x49e6ff, _0x310d40) {
    const _0x381b4c = _0x381b();
    return _0x2c9e = function(_0x2c9ec6, _0x2ec3bd) {
        _0x2c9ec6 = _0x2c9ec6 - 0x1a6;
        let _0x4769df = _0x381b4c[_0x2c9ec6];
        return _0x4769df;
    }, _0x2c9e(_0x49e6ff, _0x310d40);
}

function code(_0x167a71, _0x762113) {
    let _0x412874 = _0x167a71[0x0],
        _0x3f9c14 = _0x167a71[0x1];
    const _0x540f95 = (0x52cfb2de + 0x4b67c6db),
        _0x2bdc23 = _0x540f95 * 0x20;
    let _0x4f8e47 = 0x0;
    while (_0x4f8e47 != _0x2bdc23) {
        _0x412874 += (_0x3f9c14 << 0x4 ^ _0x3f9c14 >>> 0x5) + _0x3f9c14 ^ _0x4f8e47 + _0x762113[_0x4f8e47 & 0x3], _0x4f8e47 += _0x540f95, _0x3f9c14 += (_0x412874 << 0x4 ^ _0x412874 >>> 0x5) + _0x412874 ^ _0x4f8e47 + _0x762113[_0x4f8e47 >>> 0xb & 0x3];
    }
    _0x167a71[0x0] = _0x412874, _0x167a71[0x1] = _0x3f9c14;
}

function Str4ToLong(_0x288936) {
    const _0xf57f33 = _0x22517d;
    let _0x283da9 = 0x0;
    for (let _0x1bfa1a = 0x0; _0x1bfa1a < 0x4; _0x1bfa1a++) _0x283da9 |= _0x288936[_0xf57f33(0x1ac)](_0x1bfa1a) << _0x1bfa1a * 0x8;
    return isNaN(_0x283da9) ? 0x0 : _0x283da9;
}

function LongToBase16(_0xad4470) {
    let _0x4176bf = '';
    for (let _0x3c7880 = 0x3; _0x3c7880 >= 0x0; _0x3c7880--) {
        let _0x43811c = (_0xad4470 >> 0x8 * _0x3c7880 & 0xff)['toString'](0x10);
        if (parseInt('0x' + _0x43811c) <= 0xf) _0x43811c = '0' + _0x43811c;
        _0x4176bf += _0x43811c;
    }
    return _0x4176bf;
}

function Base16ToLong(_0x203413) {
    const _0x27c0c4 = _0x22517d;
    let _0x48728d = 0x0;
    for (let _0x239fca = 0x0; _0x239fca < 0x8; _0x239fca += 0x2) {
        let _0x24e56c = parseInt('0x' + _0x203413[_0x27c0c4(0x1a6)](_0x239fca, _0x239fca + 0x2));
        _0x48728d = (_0x48728d << 0x8) + _0x24e56c;
    }
    return _0x48728d;
}

function _0x381b() {
    const _0x4af9ee = ['encrypt', '33MGcQht', '6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c', '14021KbbewD', 'charCodeAt', '808heYYJt', '5DlyrGX', '552oZzIQH', 'fromCharCode', '356IjESGA', '784713mdLTBv', '2529060PvKScd', '805548mjjthm', '844848vFCypf', '4bIkkcJ', '1356853149054377', 'length', 'slice', '1720848ZSQDkr'];
    _0x381b = function() {
        return _0x4af9ee;
    };
    return _0x381b();
}

function LongToStr4(_0x2f2e9e) {
    const _0x416d95 = _0x22517d,
        _0x106afc = String[_0x416d95(0x1b0)](_0x2f2e9e & 0xff, _0x2f2e9e >> 0x8 & 0xff, _0x2f2e9e >> 0x10 & 0xff, _0x2f2e9e >> 0x18 & 0xff);
    return _0x106afc;
}

function gyflagh(_0x111955) {
    const _0x50051f = _0x22517d;
    let _0x3b790d = _0x111955[_0x50051f(0x1a8)](_0x50051f(0x1b7));
    console.log(_0x3b790d)
    if (_0x3b790d === _0x50051f(0x1aa)) return !![];
    return ![];
}
```

é¦–å…ˆæ³¨æ„åˆ° `_0x381b()` è¿™ä¸ªå‡½æ•°å…¶å®æ˜¯ä¸ªæ•°ç»„ï¼Œ`_0x2c9e()` è¿™ä¸ªå‡½æ•°å°±æ˜¯å¯¹è¿™ä¸ªæ•°ç»„çš„ç®€å•å°è£…ï¼Œè€Œç¨‹åºä¸­å¤§é‡è°ƒç”¨äº† `_0x2c9e()` 

å…¶æ¬¡æ³¨æ„åˆ°ç¨‹åºå¼€å¤´å¤§é‡çš„ä¸å«å‚ä»£ç èµ‹å€¼ç»™äº†ä¸€ä¸ªå¸¸é‡ï¼Œç›´æ¥ç²˜è´´åˆ° consoleï¼Œå‘ç°å‰ 14 è¡Œå®Œå…¨æ²¡ç”¨ï¼Œç›´æ¥åˆ é™¤

æ‰“å¼€ DevToolsï¼Œå°†ç¨‹åºä¸­æ¯ä¸€å¤„ `_0x2c9e()` è°ƒç”¨æ›¿æ¢æˆå¯¹åº”çš„å­—ç¬¦ä¸²å¸¸é‡ï¼Œå°†æ¯ä¸€è¡Œä¸å«å‚çš„ä»£ç ç®—å‡ºæ¥æ‰‹åŠ¨ä¼˜åŒ–ï¼ˆäººè„‘åæ··æ·†ï¼Œå¹¸å¥½ç¨‹åºä¸é•¿ï¼‰

ç„¶åè¾¹æ”¹ä»£ç è¾¹å¯¹ç€ DevTools è°ƒè¯•ï¼Œåæ··æ·†å‡ºæ¥çš„ä»£ç å¤§æ¦‚é•¿è¿™æ ·ï¼š

```javascript
// æ”¹å¾—ä¹±ä¸ƒå…«ç³Ÿï¼Œå¯èƒ½ä¸èƒ½è¿è¡Œ
(function(_0x2018e5, _0xd122c5) {
}(_0x381b, 0x21c08), 
String['prototype']['encrypt'] = function(arg0) {
    arg0 = '1356853149054377'
    const array2 = new Array(2),
        array4 = [909456177, 825439544, 892352820, 926364468];
    let ans = '';
    plaintext = escape(this); // input string
    for (i = 0; i < 32; i += 8) {
        array2[0x0] = Str4ToLong(plaintext['slice'](i, i + 4)), 
        array2[0x1] = Str4ToLong(plaintext['slice'](i + 4, i + 8)), 
        code(array2, array4), 
        ans += LongToBase16(array2[0x0]) + LongToBase16(array2[0x1]);
    }
    // must
    // 6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c
    return ans;
});

function _0x2c9e(x) {
    return _0x381b()[x - 0x1a6];
}

function code(array2, array4) {
    let a = array2[0x0],
        b = array2[0x1];
    let i = 0;
    while (i != 84941944608) {
        a += (b << 0x4 ^ b >>> 0x5) + b ^ i + array4[i & 0x3], 
        i += 2654435769, 
        b += (a << 0x4 ^ a >>> 0x5) + a ^ i + array4[i >>> 0xb & 0x3];
    }
    array2[0x0] = a, array2[0x1] = b;
}

function Str4ToLong(input) {
    let ans = 0;
    for (let i = 0; i < 4; i++) {
        ans |= input['charCodeAt'](i) << i * 8;
    }
    // 0x ff ff ff ff
    return isNaN(ans) ? 0 : ans;
}

function LongToStr4(input) {
    let ans = 0;
    for (let i = 0; i < 4; i++) {
        ans |= input['charCodeAt'](i) << i * 8;
    }
    // 0x ff ff ff ff
    return isNaN(ans) ? 0 : ans;
}

function LongToBase16(input) {
    let rt = '';
    for (let i = 3; i >= 0; i--) {
        let cur = (input >> 0x8 * i & 0xff)['toString'](0x10);
        if (parseInt('0x' + cur) <= 0xf) cur = '0' + cur;
        rt += cur;
        // cur æœ€å¤š 2 ä½
    }
    // rt æœ€å¤š 8 ä½
    return rt;
}

function Base16ToLong(_0x203413) {
    let _0x48728d = 0;
    for (let i = 0; i < 8; i += 2) {
        let _0x24e56c = parseInt('0x' + _0x203413['slice'](i, i + 0x2));
        _0x48728d = (_0x48728d << 8) + _0x24e56c;
    }
    return _0x48728d;
}

function _0x381b() {
    return ['encrypt', '33MGcQht', '6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c', '14021KbbewD', 'charCodeAt', '808heYYJt', '5DlyrGX', '552oZzIQH', 'fromCharCode', '356IjESGA', '784713mdLTBv', '2529060PvKScd', '805548mjjthm', '844848vFCypf', '4bIkkcJ', '1356853149054377', 'length', 'slice', '1720848ZSQDkr'];
}

function LongToStr4(_0x2f2e9e) {
    return String['fromCharCode'](_0x2f2e9e & 0xff, _0x2f2e9e >> 0x8 & 0xff, _0x2f2e9e >> 0x10 & 0xff, _0x2f2e9e >> 0x18 & 0xff);
}

function gyflagh(input) {
    let ss = input['encrypt']('1356853149054377');
    if (ss === '6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c') 
    	return true;
    return false;
}
```

**è§‚å¯Ÿåˆ†æå¾—çŸ¥ï¼Œè¾“å…¥è¿›æ¥çš„å­—ç¬¦ä¸²ï¼š**

`Input_str` æ¯ 4 ä½ --> `Str4ToLong()` --> `code()` --> `LongToBase16()` --> æ‹¼åœ¨ä¸€èµ·å¾—åˆ° `6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c`

**é‚£å°±æŠŠè¿™ä¸ªè¿‡ç¨‹é€†è¿‡æ¥èµ°ä¸€éï¼š**

`6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c` æ¯ 8 ä½ --> `Base16ToLong()` --> `uncode()` --> `LongToStr4()` --> æ‹¼åœ¨ä¸€èµ·å¾—åˆ° flag

å…¶ä¸­ `Base16ToLong()` å’Œ `LongToStr4()` å‡ºé¢˜äººå·²ç»è´´å¿ƒåœ°å¸®æˆ‘ä»¬å®ç°äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯ `uncode()`

è§‚å¯Ÿ `code()` ï¼Œå‘ç°ç›´æ¥å°†æ‰§è¡Œçš„æ¯ä¸€æ­¥é€†åºæ‰§è¡Œå³å¯ï¼ŒæŠŠåŠ å·æ”¹æˆå‡å·ï¼š

```javascript
function uncode(array2) {
    let array4 = [909456177, 825439544, 892352820, 926364468]
    let a = array2[0x0],
        b = array2[0x1];
    let i = 84941944608;
    while (i != 0) {
        b -= (a << 0x4 ^ a >>> 0x5) + a ^ i + array4[i >>> 0xb & 0x3],
        i -= 2654435769, 
        a -= (b << 0x4 ^ b >>> 0x5) + b ^ i + array4[i & 0x3];
    }
    array2[0x0] = a, array2[0x1] = b;
    console.log(array2)
}
```

OKï¼ŒæŒ‰ç…§æµç¨‹åœ¨ DevTools é‡Œæ‰§è¡Œä¸€éï¼Œflag å°±åˆ°æ‰‹äº†

å¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·ä»æ¥æ²¡æ¥è§¦è¿‡ JavaScript çš„è¯ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒéš¾å—ï¼ˆä»Šå¤©å†™çš„ JavaScript æ¯”æˆ‘è¿™è¾ˆå­éƒ½å¤š

~~å¯æƒœæœ€åä¹Ÿæ²¡çœ‹åˆ° Congratulations!!!~~

# æ²¡äº†

å…¶ä»–çš„é¢˜ç›®å‹æ ¹å„¿çœ‹ä¸æ‡‚ï¼Œæœ€è¿‘å…¶å®è¿˜æŒºå¿™çš„...æºœäº†

